<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>R语言基础画图教程合集(长文总结) | 生信技术</title><meta name="keywords" content="R语言"><meta name="author" content="李星泽,lixingzee@gmail.com"><meta name="copyright" content="李星泽"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="前言 这一部分会简单分享一些R语言画图的小技巧，后续相应的代码以及测试数据文件都已经上传到百度网盘，可以在**公众号(生信技术)**留言回复“ R语言 ”获取。 R包安装 需要安装 ggplot2, qqman, gplots, pheatmap, scales, reshape2, RColorBrewer 和 plotrix（使用 install.packages(), 如 install.p">
<meta property="og:type" content="article">
<meta property="og:title" content="R语言基础画图教程合集(长文总结)">
<meta property="og:url" content="http://lxz9.com/2021/12/14/R/index.html">
<meta property="og:site_name" content="生信技术">
<meta property="og:description" content="前言 这一部分会简单分享一些R语言画图的小技巧，后续相应的代码以及测试数据文件都已经上传到百度网盘，可以在**公众号(生信技术)**留言回复“ R语言 ”获取。 R包安装 需要安装 ggplot2, qqman, gplots, pheatmap, scales, reshape2, RColorBrewer 和 plotrix（使用 install.packages(), 如 install.p">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s4.ax1x.com/2021/12/15/ozG2Ed.jpg">
<meta property="article:published_time" content="2021-12-14T10:00:00.000Z">
<meta property="article:modified_time" content="2021-12-21T14:32:30.000Z">
<meta property="article:author" content="李星泽">
<meta property="article:tag" content="R语言">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s4.ax1x.com/2021/12/15/ozG2Ed.jpg"><link rel="shortcut icon" href="https://z3.ax1x.com/2021/02/09/yawIzV.png"><link rel="canonical" href="http://lxz9.com/2021/12/14/R/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?72a556f842c8990127f397d4e0c54f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QRG4NL4207"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QRG4NL4207');
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-12-21 22:32:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"  media="defer" onload="this.media='all'"><meting-js server='tencent' type='playlist' id='2134037073' fixed='true'></meting-js><style>#article-container.post-content h1:before, h2:before, h3:before, h4:before, h5:before, h6:before { -webkit-animation: avatar_turn_around 1s linear infinite; -moz-animation: avatar_turn_around 1s linear infinite; -o-animation: avatar_turn_around 1s linear infinite; -ms-animation: avatar_turn_around 1s linear infinite; animation: avatar_turn_around 1s linear infinite; }</style><link rel="stylesheet" href="/css/iconfont.css"><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="/css/lxz9.css"><link rel="stylesheet" href="/css/icon.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="生信技术" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://z3.ax1x.com/2021/03/10/6JSyoq.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">33</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">48</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/map/"><i class="fa-fw fas fa-heart"></i><span> 地图</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://s4.ax1x.com/2021/12/15/ozG2Ed.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">生信技术</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/map/"><i class="fa-fw fas fa-heart"></i><span> 地图</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">R语言基础画图教程合集(长文总结)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-14T10:00:00.000Z" title="发表于 2021-12-14 18:00:00">2021-12-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-21T14:32:30.000Z" title="更新于 2021-12-21 22:32:30">2021-12-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/R%E8%AF%AD%E8%A8%80/">R语言</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>50分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="前言">前言</h1>
<p>这一部分会简单分享一些R语言画图的小技巧，后续相应的代码以及测试数据文件都已经上传到百度网盘，可以在**公众号(生信技术)**留言回复“ <strong>R语言</strong> ”获取。</p>
<h1 id="R包安装">R包安装</h1>
<p>需要安装 ggplot2, qqman, gplots, pheatmap, scales, reshape2, RColorBrewer 和 plotrix（使用 <code>install.packages()</code>, 如 <code>install.packages('ggplot2')</code></p>
<p>下面是后续需要用到的一些R包，如果需要新下载后面文章会继续介绍。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(qqman)</span><br><span class="line">library(gplots)</span><br><span class="line">library(pheatmap)</span><br><span class="line">library(scales)</span><br><span class="line">library(reshape2)</span><br><span class="line">library(RColorBrewer)</span><br><span class="line">library(plyr)</span><br><span class="line">library(plotrix)</span><br><span class="line">library(ggpubr) <span class="comment">#用于带统计检验的箱线图</span></span><br></pre></td></tr></table></figure>
<h1 id="加载数据">加载数据</h1>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Read the input files</span></span><br><span class="line"><span class="comment"># “header=T” means that the data has a title, and sep=&quot;\t&quot; is used as the separator</span></span><br><span class="line">data &lt;-read.table(<span class="string">&quot;box_plots_mtcars.txt&quot;</span>,header=<span class="built_in">T</span>,sep=<span class="string">&quot;\t&quot;</span>)</span><br><span class="line"><span class="comment"># The function c(,,) means create the vector type data </span></span><br><span class="line">df &lt;- data[, <span class="built_in">c</span>(<span class="string">&quot;mpg&quot;</span>, <span class="string">&quot;cyl&quot;</span>, <span class="string">&quot;wt&quot;</span>)]</span><br><span class="line"></span><br><span class="line">df2 &lt;-read.table(<span class="string">&quot;histogram_plots.txt&quot;</span>,header=<span class="built_in">T</span>,sep=<span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line">df3 &lt;- read.table(<span class="string">&quot;volcano_plots.txt&quot;</span>, header=<span class="built_in">T</span>)</span><br><span class="line"></span><br><span class="line">df4 &lt;- read.table(<span class="string">&quot;manhattan_plots_gwasResults.txt&quot;</span>,header=<span class="built_in">T</span>,sep=<span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line">df5 &lt;-read.table(<span class="string">&quot;heatmaps.txt&quot;</span>,header=<span class="built_in">T</span>,sep=<span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Covert data into matrix format</span></span><br><span class="line"><span class="comment"># nrow(df5) and ncol(df5) return the number of rows and columns of matrix df5 respectively.</span></span><br><span class="line">dm &lt;- data.matrix(df5[<span class="number">1</span>:nrow(df5),<span class="number">2</span>:ncol(df5)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the row names</span></span><br><span class="line">row.names(dm) &lt;- df5[,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">df6 &lt;- read.table(<span class="string">&quot;ballon_plots_GO.txt&quot;</span>, header=<span class="built_in">T</span>, sep=<span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="保存并查看图片">保存并查看图片</h1>
<p>如果要保存绘图，使用 <code>pdf()</code> + <code>dev.off()</code> 或 <code>ggsave()</code>。<br>
第二个是特定于 ggplot2 包的（即，如果 plot 的代码以 ggplot 开头，那么可以使用第二个）。</p>
<p>让我们看一个例子：</p>
<ul>
<li><code>pdf() + dev.off()</code></li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Begin to plot</span></span><br><span class="line"><span class="comment"># Output as pdf</span></span><br><span class="line">pdf(<span class="string">&quot;1.1.Basic_boxplot.pdf&quot;</span>, height = <span class="number">3</span>, width = <span class="number">3</span>)</span><br><span class="line"><span class="comment"># Mapping the X and Y </span></span><br><span class="line"><span class="comment"># Components are constructed by using &quot;+&quot;</span></span><br><span class="line">ggplot(df, aes(x=cyl, y=mpg))+ </span><br><span class="line"><span class="comment"># draw the boxplot and fill it with gray</span></span><br><span class="line">  geom_boxplot(fill=<span class="string">&quot;gray&quot;</span>)+</span><br><span class="line"><span class="comment"># Use the labs function to set the title and modify x and y</span></span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl&quot;</span>,x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>)+</span><br><span class="line"><span class="comment"># Set the theme style</span></span><br><span class="line">  theme_classic()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the plot</span></span><br><span class="line">dev.off()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ggsave()</code></li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Begin to plot</span></span><br><span class="line">p &lt;- ggplot(df, aes(x=cyl, y=mpg)) + </span><br><span class="line">  geom_boxplot(fill=<span class="string">&quot;gray&quot;</span>)+</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl&quot;</span>,x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>)+</span><br><span class="line">  theme_classic()</span><br><span class="line"><span class="comment"># Sava as pdf</span></span><br><span class="line">ggsave(<span class="string">&quot;1.1.Basic_boxplot.pdf&quot;</span>, plot=p, height = <span class="number">3</span>, width = <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h1 id="R包导出高质量可编辑图形">R包导出高质量可编辑图形</h1>
<p>下面总结了一些输出高清可编辑图片的方式，更好的适用于科研投稿的高质量图片要求</p>
<ol>
<li>
<p>SCI常见格式</p>
</li>
<li>
<p>矢量图和位图</p>
</li>
<li>
<p>ggsave函数(ggplot2包)</p>
</li>
<li>
<p>Cairo包</p>
</li>
<li>
<p>export包</p>
</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#高质量图形的导出</span></span><br><span class="line"><span class="comment">#内置图形导出函数</span></span><br><span class="line">png(<span class="string">&#x27;P1.png&#x27;</span>,height = <span class="number">1200</span>,width = <span class="number">1200</span>,res=<span class="number">300</span>) <span class="comment">#投稿一般要求res分辨率300以上</span></span><br><span class="line">ggplot(dsamp,aes(carat,price,fill= cut))+</span><br><span class="line">  geom_point(size __3.shane =<span class="number">21.</span> color= <span class="string">&#x27;gray30&#x27;</span>)+</span><br><span class="line">  theme_test()+</span><br><span class="line">  scale_fill_npg()+</span><br><span class="line">  theme(legend.position =<span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">dev.off()</span><br><span class="line"></span><br><span class="line"><span class="comment">###ggsave函数</span></span><br><span class="line">ggplot(dsamp,aes(carat,price,fill= cut))+</span><br><span class="line">  geom_point(size = <span class="number">3</span>,shape =<span class="number">21</span>, color =<span class="string">&#x27;gray30&#x27;</span>)+</span><br><span class="line">  theme_test()+</span><br><span class="line">  scale_fill_npg()+</span><br><span class="line">  theme(legend.position = <span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;p2.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">###cairo包</span></span><br><span class="line">install.packages(<span class="string">&#x27;Cairo&#x27;</span>)</span><br><span class="line">library(Cairo)</span><br><span class="line">CairoPNG(<span class="string">&#x27;P1.png&#x27;</span>,height = <span class="number">1200</span>,width = <span class="number">1200</span>,res=<span class="number">300</span>)</span><br><span class="line">ggplot(dsamp,aes(carat,price,fill= cut))+</span><br><span class="line">  geom_point(size = <span class="number">3</span>,shape =<span class="number">21</span>, color =<span class="string">&#x27;gray30&#x27;</span>)+</span><br><span class="line">  theme_test()+</span><br><span class="line">  scale_fill_npg()+</span><br><span class="line">  theme(legend.position = <span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">dev.off()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CairoPDF(<span class="string">&#x27;p1.pdf&#x27;</span>,height=<span class="number">6</span>,width =<span class="number">6</span>)</span><br><span class="line">ggplot(dsamp,aes(carat,price,fill= cut))+</span><br><span class="line">  geom_point(size = <span class="number">3</span>,shape =<span class="number">21</span>, color=<span class="string">&#x27;gray30&#x27;</span>)+</span><br><span class="line">  theme_test()+</span><br><span class="line">  scale_fill_npg()+</span><br><span class="line">  theme(legend.position = <span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">dev.off()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###利用rstudio导出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##export包</span></span><br><span class="line">install. packages(<span class="string">&#x27;export&#x27;</span>)</span><br><span class="line">library(export)</span><br><span class="line">p &lt;- ggplot(dsamp,aes(carat,price,fill= cut))+</span><br><span class="line">  geom_point(size =<span class="number">3</span>,shape =<span class="number">21</span>, color=<span class="string">&#x27;gray30&#x27;</span>)+</span><br><span class="line">  theme_test()+</span><br><span class="line">  scale_fill_npg()+</span><br><span class="line">  theme(legend. position = <span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">graph2ppt(p)</span><br></pre></td></tr></table></figure>
<h1 id="箱线图">箱线图</h1>
<h2 id="基本箱线图制作">基本箱线图制作</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; df$cyl &lt;- as.factor(df$cyl)</span><br><span class="line"></span><br><span class="line">&gt; head(df)</span><br><span class="line">                   mpg cyl    wt</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">2.620</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span> <span class="number">2.875</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">2.320</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">3.215</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">3.440</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">3.460</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df, aes(x=cyl, y=mpg)) + </span><br><span class="line">  geom_boxplot(fill=<span class="string">&quot;gray&quot;</span>)+</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl(Test data)&quot;</span>,x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>)+</span><br><span class="line">  theme_classic()</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p1.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/oho0S0.png" alt></p>
<h2 id="按组更改连续颜色">按组更改连续颜色</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df, aes(x=cyl, y=mpg, fill=cyl)) + </span><br><span class="line">  geom_boxplot()+</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl (Test data)&quot;</span>,x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>) +</span><br><span class="line">  scale_fill_brewer(palette=<span class="string">&quot;Blues&quot;</span>) + </span><br><span class="line">  theme_bw()</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p2.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohoaYn.png" alt></p>
<h2 id="分组箱线图">分组箱线图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Read the data table</span></span><br><span class="line">data=read.csv(<span class="string">&quot;boxplot_example.csv&quot;</span>)</span><br><span class="line"><span class="comment">###################</span></span><br><span class="line"><span class="comment">#I.Prepare the data</span></span><br><span class="line"><span class="comment">#1.Normalize the data, etc</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">12</span>:<span class="number">17</span>)&#123;</span><br><span class="line">    data[,i]=<span class="built_in">log</span>(data[,i]+<span class="number">1e-3</span>) <span class="comment"># log some expression values</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">9</span>:<span class="number">17</span>) &#123;</span><br><span class="line">    maxValue=<span class="built_in">max</span>(data[,i])  <span class="comment">#scale the data into 0-1</span></span><br><span class="line">    minValue=<span class="built_in">min</span>(data[,i])</span><br><span class="line">    <span class="built_in">range</span>=maxValue-minValue</span><br><span class="line">    data[,i]=(data[,i]-minValue)/<span class="built_in">range</span></span><br><span class="line">&#125;</span><br><span class="line">data$X8.Identity=data$X8.Identity/<span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.Make the new matrix for boxplot: cleaning the data table</span></span><br><span class="line">library(<span class="string">&quot;reshape&quot;</span>)</span><br><span class="line">m=melt(data[,<span class="built_in">c</span>(<span class="number">2</span>,<span class="number">7</span>:<span class="number">12</span>,<span class="number">14</span>:<span class="number">17</span>)], id=<span class="number">1</span>)<span class="comment"># remove some columns not to show and reshape the matrix into 3 columns for boxplot drawing in bwplot</span></span><br><span class="line">colnames(m)=<span class="built_in">c</span>(<span class="string">&quot;Type&quot;</span>,<span class="string">&quot;Feature&quot;</span>,<span class="string">&quot;Normalized_Value&quot;</span>)  <span class="comment">#define the new column names</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.Clean the names of each type and each feature</span></span><br><span class="line"><span class="comment">#Merge sub-types of different elements</span></span><br><span class="line">m[,<span class="number">1</span>]=sub (<span class="string">&quot;ncRNA_selected&quot;</span>,<span class="string">&quot;RNAI&quot;</span>, m[,<span class="number">1</span>])</span><br><span class="line">m[,<span class="number">1</span>]=sub (<span class="string">&quot;ncRNA_3019&quot;</span>,<span class="string">&quot;RNAII&quot;</span>, m[,<span class="number">1</span>])</span><br><span class="line">m[,<span class="number">1</span>]=sub (<span class="string">&quot;exon_CCDS&quot;</span>,<span class="string">&quot;CDS&quot;</span>, m[,<span class="number">1</span>])</span><br><span class="line">m[,<span class="number">1</span>]=sub (<span class="string">&quot;five_prime_UTR&quot;</span>,<span class="string">&quot;UTR&quot;</span>, m[,<span class="number">1</span>])</span><br><span class="line">m[,<span class="number">1</span>]=sub (<span class="string">&quot;three_prime_UTR&quot;</span>,<span class="string">&quot;UTR&quot;</span>, m[,<span class="number">1</span>])</span><br><span class="line">m[,<span class="number">1</span>]=sub (<span class="string">&quot;ancestral_repeat&quot;</span>,<span class="string">&quot;AP&quot;</span>, m[,<span class="number">1</span>])</span><br><span class="line"><span class="comment">#Rename the feature</span></span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X7.GC&#x27;</span>,<span class="string">&#x27;01.GC Content&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X8.Identity&#x27;</span>,<span class="string">&#x27;02.DNA Conservation&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X9.z_score&#x27;</span>,<span class="string">&#x27;03.RNA Struc. Free Energy&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X10.SCI&#x27;</span>,<span class="string">&#x27;04.RNA Struc. Cons.&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X11.tblastx_score&#x27;</span>,<span class="string">&#x27;05.Protein Conservation&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X12.polyA_RNAseq_MAX&#x27;</span>,<span class="string">&#x27;06.PolyA+ RNA-seq&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X14.small_RNAseq_MAX&#x27;</span>,<span class="string">&#x27;07.Small RNA-seq&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X15.Array_totalRNA_MAX&#x27;</span>,<span class="string">&#x27;08.Total RNA Array&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X16.Array_polyA_MAX&#x27;</span>,<span class="string">&#x27;09.PolyA+ RNA Array&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line">m[,<span class="number">2</span>]=sub(<span class="string">&#x27;X17.Array_nonpolyA_MAX&#x27;</span>,<span class="string">&#x27;10.PolyA- RNA Array&#x27;</span>,m[,<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">###########################</span></span><br><span class="line"><span class="comment">#Making Boxplot</span></span><br><span class="line">library(<span class="string">&quot;lattice&quot;</span>)</span><br><span class="line">png(<span class="string">&quot;p3.png&quot;</span>,width=<span class="number">1500</span>,height=<span class="number">500</span>) <span class="comment"># pdf is recommended for most cases, or png for figure with huge amount of data points</span></span><br><span class="line"><span class="comment">#pdf(&quot;p3.pdf&quot;) </span></span><br><span class="line">attach(m)</span><br><span class="line">bwplot(Normalized_Value ~ Type|Feature,fill=<span class="built_in">c</span>(<span class="string">&quot;red&quot;</span>,<span class="string">&quot;green&quot;</span>,<span class="string">&quot;yellow&quot;</span>,<span class="string">&quot;blue&quot;</span>,<span class="string">&quot;light blue&quot;</span>),layout=<span class="built_in">c</span>(<span class="number">10</span>,<span class="number">1</span>))</span><br><span class="line">dev.off()</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohotoj.png" alt></p>
<h2 id="带统计检验的箱线图">带统计检验的箱线图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">data(iris)</span><br><span class="line">print(levels(iris$Species))</span><br><span class="line">comparisons &lt;- <span class="built_in">list</span>(<span class="built_in">c</span>(<span class="string">&quot;versicolor&quot;</span>,<span class="string">&quot;setosa&quot;</span>),<span class="built_in">c</span>(<span class="string">&quot;virginica&quot;</span>,<span class="string">&quot;versicolor&quot;</span>),<span class="built_in">c</span>(<span class="string">&quot;virginica&quot;</span>,<span class="string">&quot;setosa&quot;</span>))</span><br><span class="line">ggplot(iris,aes(x=Species,y=Sepal.Length,fill=Species))+geom_boxplot(alpha = <span class="number">1</span>, size = <span class="number">1</span>, position = position_dodge(<span class="number">1.1</span>),outlier.size=<span class="number">0</span>,outlier.alpha = <span class="number">0</span>)+</span><br><span class="line">  geom_point(size = <span class="number">1</span>, position = position_jitterdodge(dodge.width=<span class="number">0.3</span>,jitter.width = <span class="number">0.3</span>))+</span><br><span class="line">  scale_fill_brewer(palette=<span class="string">&quot;Blues&quot;</span>) +</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(<span class="comment">#legend.position=&quot;right&quot;,</span></span><br><span class="line">    legend.position=<span class="string">&quot;right&quot;</span>,</span><br><span class="line">    panel.grid=element_blank(),</span><br><span class="line">    panel.border=element_blank(),</span><br><span class="line">    axis.line = element_line(size=<span class="number">1</span>, colour = <span class="string">&quot;black&quot;</span>),</span><br><span class="line">    legend.title = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>,family = <span class="string">&quot;Arial&quot;</span>, size=<span class="number">10</span>),</span><br><span class="line">    legend.text= element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>,family = <span class="string">&quot;Arial&quot;</span>, size=<span class="number">10</span>),</span><br><span class="line">    plot.title = element_text(hjust = <span class="number">0.5</span>,size=<span class="number">10</span>,face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">    axis.text.x = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>, size=<span class="number">10</span>,angle = <span class="number">45</span>,hjust = <span class="number">1</span>),</span><br><span class="line">    axis.text.y = element_text(face=<span class="string">&quot;bold&quot;</span>,  color=<span class="string">&quot;black&quot;</span>, size=<span class="number">10</span>),</span><br><span class="line">    axis.title.x = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>, size=<span class="number">10</span>),</span><br><span class="line">    axis.title.y = element_text(face=<span class="string">&quot;bold&quot;</span>,color=<span class="string">&quot;black&quot;</span>, size=<span class="number">10</span>))+</span><br><span class="line">stat_compare_means(comparisons = comparisons,</span><br><span class="line">                   method = <span class="string">&quot;wilcox.test&quot;</span>,</span><br><span class="line">                   method.args = <span class="built_in">list</span>(alternative = <span class="string">&quot;greater&quot;</span>),</span><br><span class="line">                   label = <span class="string">&quot;p.signif&quot;</span></span><br><span class="line">)+labs(x=<span class="string">&quot;&quot;</span>,title=<span class="string">&quot;Boxplot and statistical test&quot;</span>, face=<span class="string">&quot;bold&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p4.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohoDyT.png" alt></p>
<h1 id="小提琴图">小提琴图</h1>
<h2 id="基本小提琴图制作">基本小提琴图制作</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; df$cyl &lt;- as.factor(df$cyl)</span><br><span class="line"></span><br><span class="line">&gt; head(df)</span><br><span class="line">                   mpg cyl    wt</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">2.620</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span> <span class="number">2.875</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">2.320</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">3.215</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">3.440</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">3.460</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df, aes(x=cyl, y=mpg)) +</span><br><span class="line"> geom_violin(trim=<span class="literal">FALSE</span>) +</span><br><span class="line"> labs(title=<span class="string">&quot;Plot of mpg per cyl (Test data)&quot;</span>, x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p5.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohoJeg.png" alt></p>
<h2 id="在小提琴图上添加汇总统计">在小提琴图上添加汇总统计</h2>
<h3 id="添加中位数和四分位数">添加中位数和四分位数</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df, aes(x=cyl, y=mpg)) + </span><br><span class="line">  geom_violin(trim=<span class="literal">FALSE</span>) +</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl (Test data)&quot;</span>, x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>) +</span><br><span class="line">  stat_summary(fun.y=mean, geom=<span class="string">&quot;point&quot;</span>, shape=<span class="number">23</span>, size=<span class="number">2</span>, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p6.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohoYwQ.png" alt></p>
<p>或者</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> ggplot(df, aes(x=cyl, y=mpg)) + </span><br><span class="line">   geom_violin(trim=<span class="literal">FALSE</span>) +</span><br><span class="line">   labs(title=<span class="string">&quot;Plot of mpg per cyl (Test data)&quot;</span>, x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>) +</span><br><span class="line">   geom_boxplot(width=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p7.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://imgtu.com/i/oho8OS" alt></p>
<h3 id="添加均值和标准差">添加均值和标准差</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df, aes(x=cyl, y=mpg)) + </span><br><span class="line">  geom_violin(trim=<span class="literal">FALSE</span>) +</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl (Test data)&quot;</span>, x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>) +</span><br><span class="line">  stat_summary(fun.data=<span class="string">&quot;mean_sdl&quot;</span>, fun.args = <span class="built_in">list</span>(mult = <span class="number">1</span>), geom=<span class="string">&quot;crossbar&quot;</span>, width=<span class="number">0.1</span> )</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p8.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/oho3y8.png" alt></p>
<p>或者</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df, aes(x=cyl, y=mpg)) + </span><br><span class="line">  geom_violin(trim=<span class="literal">FALSE</span>) +</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl (Test data)&quot;</span>, x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>) +</span><br><span class="line">  stat_summary(fun.data=mean_sdl, fun.args = <span class="built_in">list</span>(mult = <span class="number">1</span>), geom=<span class="string">&quot;pointrange&quot;</span>, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p9.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/oho1Qf.png" alt></p>
<h3 id="更改小提琴图填充颜色">更改小提琴图填充颜色</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df, aes(x=cyl, y=mpg, fill=cyl)) + </span><br><span class="line">  geom_violin(trim=<span class="literal">FALSE</span>) +</span><br><span class="line">  geom_boxplot(width=<span class="number">0.1</span>, fill=<span class="string">&quot;white&quot;</span>) +</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of mpg per cyl&quot;</span>, x=<span class="string">&quot;Cyl&quot;</span>, y = <span class="string">&quot;Mpg&quot;</span>) +</span><br><span class="line">  scale_fill_brewer(palette=<span class="string">&quot;Reds&quot;</span>) + </span><br><span class="line">  theme_classic()</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p10.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/oholSP.png" alt></p>
<h1 id="直方图">直方图</h1>
<p>本R 教程介绍了如何使用 <em><strong>ggplot2</strong></em> 包创建直方图。</p>
<p>使用函数<code>geom_histogram()</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df2 &lt;-read.table(<span class="string">&quot;histogram_plots.txt&quot;</span>,header=<span class="built_in">T</span>,sep=<span class="string">&quot;\t&quot;</span>)</span><br><span class="line"><span class="comment"># 测试数据文件可在公众号回复关键词( R语言 )获取</span></span><br></pre></td></tr></table></figure>
<h2 id="基础直方图制作">基础直方图制作</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(df2)</span><br><span class="line">  sex weight</span><br><span class="line">1   <span class="built_in">F</span>     <span class="number">49</span></span><br><span class="line">2   <span class="built_in">F</span>     <span class="number">56</span></span><br><span class="line">3   <span class="built_in">F</span>     <span class="number">60</span></span><br><span class="line">4   <span class="built_in">F</span>     <span class="number">43</span></span><br><span class="line">5   <span class="built_in">F</span>     <span class="number">57</span></span><br><span class="line">6   <span class="built_in">F</span>     <span class="number">58</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"><span class="comment"># 基础直方图</span></span><br><span class="line">ggplot(df2, aes(x=weight)) + geom_histogram()</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p11-1.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 改变bins的宽度</span></span><br><span class="line">ggplot(df2, aes(x=weight)) + </span><br><span class="line">  geom_histogram(binwidth=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p11-2.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 改变颜色</span></span><br><span class="line">ggplot(df2, aes(x=weight)) + </span><br><span class="line">  geom_histogram(color=<span class="string">&quot;black&quot;</span>, fill=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p11-3.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX94YT.png" alt="p11-1，2，3"></p>
<h2 id="在直方图上添加平均线和密度图">在直方图上添加平均线和密度图</h2>
<p>使用函数<code>geom_vline</code>可以为平均值添加一条线。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加平均线</span></span><br><span class="line">ggplot(df2, aes(x=weight)) + </span><br><span class="line">  geom_histogram(binwidth=<span class="number">1</span>, color=<span class="string">&quot;black&quot;</span>, fill=<span class="string">&quot;white&quot;</span>) +</span><br><span class="line">  geom_vline(aes(xintercept=mean(weight)),</span><br><span class="line">            color=<span class="string">&quot;red&quot;</span>, linetype=<span class="string">&quot;dashed&quot;</span>, size=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p12-1.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加密度图</span></span><br><span class="line">ggplot(df2, aes(x=weight)) + </span><br><span class="line"> geom_histogram(aes(y=..density..), colour=<span class="string">&quot;black&quot;</span>, fill=<span class="string">&quot;white&quot;</span>)+</span><br><span class="line"> geom_density(alpha=<span class="number">.2</span>, fill=<span class="string">&quot;#87CEEB&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p12-2.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX9hkV.png" alt="p12-1,2"></p>
<h2 id="更改直方图填充颜色和线的类型">更改直方图填充颜色和线的类型</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改变线的颜色和填充颜色</span></span><br><span class="line">ggplot(df2, aes(x=weight))+</span><br><span class="line">  geom_histogram(color=<span class="string">&quot;darkblue&quot;</span>, fill=<span class="string">&quot;lightblue&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-1.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 改变线的类型</span></span><br><span class="line"></span><br><span class="line">ggplot(df2, aes(x=weight))+</span><br><span class="line">  geom_histogram(color=<span class="string">&quot;black&quot;</span>, fill=<span class="string">&quot;lightblue&quot;</span>,</span><br><span class="line">                 linetype=<span class="string">&quot;dashed&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-2.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX9WT0.png" alt="p13-1,2"></p>
<h2 id="按组更改直方图颜色">按组更改直方图颜色</h2>
<h3 id="计算每组的平均值：">计算每组的平均值：</h3>
<p><strong>plyr包</strong>用于计算每组的平均weight：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(plyr)</span><br><span class="line">mu &lt;- ddply(df2, <span class="string">&quot;sex&quot;</span>, summarise, grp.mean=mean(weight))</span><br><span class="line">head(mu)</span><br><span class="line"></span><br><span class="line">  sex grp.mean</span><br><span class="line">1   <span class="built_in">F</span>    <span class="number">54.70</span></span><br><span class="line">2   M    <span class="number">65.36</span></span><br></pre></td></tr></table></figure>
<h3 id="更改线条颜色">更改线条颜色</h3>
<p>直方图绘制的线条颜色可以通过变量sex的水平自动控制。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按组更改直方图的线和填充颜色</span></span><br><span class="line">ggplot(df2, aes(x=weight, color=sex)) +</span><br><span class="line">  geom_histogram(fill=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-3.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 重叠直方图</span></span><br><span class="line">ggplot(df2, aes(x=weight, color=sex)) +</span><br><span class="line">  geom_histogram(fill=<span class="string">&quot;white&quot;</span>, alpha=<span class="number">0.5</span>, position=<span class="string">&quot;identity&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-4.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX9Rwq.png" alt="p13-3,4"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 交错直方图</span></span><br><span class="line">ggplot(df2, aes(x=weight, color=sex)) +</span><br><span class="line">  geom_histogram(fill=<span class="string">&quot;white&quot;</span>, position=<span class="string">&quot;dodge&quot;</span>)+</span><br><span class="line">  theme(legend.position=<span class="string">&quot;top&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-5.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加平均线</span></span><br><span class="line">p &lt;- ggplot(df2, aes(x=weight, color=sex)) +</span><br><span class="line">  geom_histogram(fill=<span class="string">&quot;white&quot;</span>, position=<span class="string">&quot;dodge&quot;</span>)+</span><br><span class="line">  geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),</span><br><span class="line">             linetype=<span class="string">&quot;dashed&quot;</span>)+</span><br><span class="line">  theme(legend.position=<span class="string">&quot;top&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-6.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX9WT0.png" alt="p13-5,6"></p>
<p>也可以使用以下函数手动更改直方图绘制线条颜色：</p>
<p><code>scale_color_manual()</code> : 使用自定义颜色<br>
<code>scale_color_brewer()</code>：使用来自 <em>RColorBrewer</em> 包的调色板<br>
<code>scale_color_grey()</code>：使用灰色调色板</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用自定义调色板</span></span><br><span class="line">p+scale_color_manual(values=<span class="built_in">c</span>(<span class="string">&quot;#87CEEB&quot;</span>, <span class="string">&quot;#9ACD32&quot;</span>, <span class="string">&quot;#F4A460&quot;</span>))</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-7.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用brewer调色板</span></span><br><span class="line">p+scale_color_brewer(palette=<span class="string">&quot;Dark2&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-8.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用灰色</span></span><br><span class="line">p + scale_color_grey() + theme_classic() +</span><br><span class="line">  theme(legend.position=<span class="string">&quot;top&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-9.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX92mn.png" alt="p13-7,8,9"></p>
<h3 id="更改填充颜色">更改填充颜色</h3>
<p>直方图的填充颜色可以由sex自动控制：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按组更改直方图并填充颜色</span></span><br><span class="line">ggplot(df2, aes(x=weight, fill=sex, color=sex)) +</span><br><span class="line">  geom_histogram(position=<span class="string">&quot;identity&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-10.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用半透明填充</span></span><br><span class="line">ggplot(df2, aes(x=weight, fill=sex, color=sex)) +</span><br><span class="line">  geom_histogram(position=<span class="string">&quot;identity&quot;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p13-11.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX96yj.png" alt="p13-10,11"></p>
<h1 id="密度图">密度图</h1>
<p>本R 教程介绍了如何使用 <strong>ggplot2包</strong> 创建密度图。</p>
<p>使用函数<code>geom_density()</code></p>
<h2 id="准备数据">准备数据</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">set.seed(<span class="number">1234</span>)</span><br><span class="line">df &lt;- data.frame(</span><br><span class="line">  sex=factor(<span class="built_in">rep</span>(<span class="built_in">c</span>(<span class="string">&quot;F&quot;</span>, <span class="string">&quot;M&quot;</span>), each=<span class="number">200</span>)),</span><br><span class="line">  weight=<span class="built_in">round</span>(<span class="built_in">c</span>(rnorm(<span class="number">200</span>, mean=<span class="number">55</span>, sd=<span class="number">5</span>),</span><br><span class="line">                 rnorm(<span class="number">200</span>, mean=<span class="number">65</span>, sd=<span class="number">5</span>)))</span><br><span class="line">  )</span><br><span class="line">head(df)</span><br><span class="line"></span><br><span class="line"><span class="comment">##   sex weight</span></span><br><span class="line"><span class="comment">## 1   F     49</span></span><br><span class="line"><span class="comment">## 2   F     56</span></span><br><span class="line"><span class="comment">## 3   F     60</span></span><br><span class="line"><span class="comment">## 4   F     43</span></span><br><span class="line"><span class="comment">## 5   F     57</span></span><br><span class="line"><span class="comment">## 6   F     58</span></span><br></pre></td></tr></table></figure>
<h2 id="基本密度图">基本密度图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基本密度图</span></span><br><span class="line">ggplot(df, aes(x=weight)) + </span><br><span class="line">  geom_density()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加平均线</span></span><br><span class="line">ggplot(df, aes(x=weight)) + </span><br><span class="line">  geom_density() + </span><br><span class="line">  geom_vline(aes(xintercept=mean(weight)),</span><br><span class="line">            color=<span class="string">&quot;red&quot;</span>, linetype=<span class="string">&quot;dashed&quot;</span>, size=<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX9dTP.png" alt></p>
<h2 id="更改密度图线类型和颜色">更改密度图线类型和颜色</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改变密度图线的类型以及填充颜色</span></span><br><span class="line">ggplot(df, aes(x=weight))+</span><br><span class="line">  geom_density(color=<span class="string">&quot;darkblue&quot;</span>, fill=<span class="string">&quot;lightblue&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;m3.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 改变线的类型</span></span><br><span class="line">ggplot(df, aes(x=weight))+</span><br><span class="line">  geom_density(linetype=<span class="string">&quot;dashed&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;m4.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX9awt.png" alt></p>
<h2 id="按组更改密度图颜色">按组更改密度图颜色</h2>
<h3 id="计算每组的平均值">计算每组的平均值</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(plyr)</span><br><span class="line">mean &lt;- ddply(df, <span class="string">&quot;sex&quot;</span>, summarise, grp.mean=mean(weight))</span><br><span class="line">head(mean)</span><br><span class="line"></span><br><span class="line"><span class="comment">##   sex grp.mean</span></span><br><span class="line"><span class="comment">## 1   F    54.70</span></span><br><span class="line"><span class="comment">## 2   M    65.36</span></span><br></pre></td></tr></table></figure>
<h3 id="更改线条颜色-2">更改线条颜色</h3>
<p>密度图线的颜色可以通过 <strong>sex</strong> 自动控制：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据分组改变密度图线的颜色</span></span><br><span class="line">ggplot(df, aes(x=weight, color=sex)) +</span><br><span class="line">  geom_density()</span><br><span class="line">ggsave(<span class="string">&#x27;m5.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 添加平均线</span></span><br><span class="line">test &lt;- ggplot(df, aes(x=weight, color=sex)) +</span><br><span class="line">  geom_density()+</span><br><span class="line">  geom_vline(data=mean, aes(xintercept=grp.mean, color=sex),</span><br><span class="line">             linetype=<span class="string">&quot;dashed&quot;</span>)</span><br><span class="line"></span><br><span class="line">test</span><br><span class="line">ggsave(<span class="string">&#x27;m6.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX9UeI.png" alt></p>
<p>也可以使用以下函数手动更改密度图线颜色：</p>
<p><code>scale_color_manual()</code> : 使用自定义颜色<br><br>
<code>scale_color_brewer()</code>：使用RColorBrewer包的调色板<br><br>
<code>scale_color_grey()</code>：使用灰色调色板<br></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用自定义颜色</span></span><br><span class="line">test + scale_color_manual(values=<span class="built_in">c</span>(<span class="string">&quot;#1E90FF&quot;</span>, <span class="string">&quot;#FF69B4&quot;</span>))</span><br><span class="line">ggsave(<span class="string">&#x27;m7.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用 brewer 调色板</span></span><br><span class="line">test + scale_color_brewer(palette=<span class="string">&quot;Set2&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;m8.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用灰色调色板</span></span><br><span class="line">test + scale_color_grey() + theme_classic()</span><br><span class="line">ggsave(<span class="string">&#x27;m9.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX9GSe.png" alt></p>
<h3 id="更改填充颜色-2">更改填充颜色</h3>
<p>密度图填充颜色可以由 <strong>sex</strong> 自动控制</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据分组改变密度图填充颜色</span></span><br><span class="line">ggplot(df, aes(x=weight, fill=sex)) +</span><br><span class="line">  geom_density()</span><br><span class="line">ggsave(<span class="string">&#x27;m10.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用半透明填充</span></span><br><span class="line">test2&lt;-ggplot(df, aes(x=weight, fill=sex)) +</span><br><span class="line">  geom_density(alpha=<span class="number">0.3</span>)</span><br><span class="line">test2</span><br><span class="line">ggsave(<span class="string">&#x27;m11.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 添加均值线</span></span><br><span class="line">test2+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),</span><br><span class="line">             linetype=<span class="string">&quot;dashed&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;m12.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX93WD.png" alt></p>
<p>手动更改密度图填充颜色：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用自定义颜色</span></span><br><span class="line">test2 + scale_fill_manual(values=<span class="built_in">c</span>(<span class="string">&quot;#1E90FF&quot;</span>, <span class="string">&quot;#FF69B4&quot;</span>))</span><br><span class="line">ggsave(<span class="string">&#x27;m13.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用 brewer 调色板</span></span><br><span class="line">test2 + scale_fill_brewer(palette=<span class="string">&quot;Set2&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;m14.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 使用灰色调色板</span></span><br><span class="line">test2 + scale_fill_grey() + theme_classic()</span><br><span class="line">ggsave(<span class="string">&#x27;m15.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX9JQH.png" alt></p>
<h3 id="更改图例位置">更改图例位置</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">test2 + theme(legend.position=<span class="string">&quot;top&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;m16.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line">test2 + theme(legend.position=<span class="string">&quot;bottom&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;m17.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line">test2 + theme(legend.position=<span class="string">&quot;none&quot;</span>) <span class="comment"># Remove legend</span></span><br><span class="line">ggsave(<span class="string">&#x27;m18.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX9tOA.png" alt></p>
<h2 id="结合直方图和密度图">结合直方图和密度图</h2>
<p>下面是直方图结合密度图的组合图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结合直方图和密度图</span></span><br><span class="line">ggplot(df, aes(x=weight)) + </span><br><span class="line"> geom_histogram(aes(y=..density..), colour=<span class="string">&quot;darkblue&quot;</span>, fill=<span class="string">&quot;white&quot;</span>)+</span><br><span class="line"> geom_density(alpha=<span class="number">.2</span>, fill=<span class="string">&quot;#00BFFF&quot;</span>) </span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;m19.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 分组</span></span><br><span class="line">ggplot(df, aes(x=weight, color=sex, fill=sex)) + </span><br><span class="line"> geom_histogram(aes(y=..density..), alpha=<span class="number">0.5</span>, </span><br><span class="line">                position=<span class="string">&quot;identity&quot;</span>)+</span><br><span class="line"> geom_density(alpha=<span class="number">.2</span>) </span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;m20.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s4.ax1x.com/2021/12/13/oX9Yyd.png" alt></p>
<h1 id="点图">点图</h1>
<p>本R 教程介绍了如何使用 <strong>ggplot2包</strong> 创建点图。</p>
<p>使用函数<code>geom_dotplot()</code>。</p>
<h2 id="准备数据-2">准备数据</h2>
<p>使用 ToothGrowth数据集：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)</span><br><span class="line">head(ToothGrowth)</span><br><span class="line"></span><br><span class="line"><span class="comment">##    len supp dose</span></span><br><span class="line"><span class="comment">## 1  4.2   VC  0.5</span></span><br><span class="line"><span class="comment">## 2 11.5   VC  0.5</span></span><br><span class="line"><span class="comment">## 3  7.3   VC  0.5</span></span><br><span class="line"><span class="comment">## 4  5.8   VC  0.5</span></span><br><span class="line"><span class="comment">## 5  6.4   VC  0.5</span></span><br><span class="line"><span class="comment">## 6 10.0   VC  0.5</span></span><br></pre></td></tr></table></figure>
<h2 id="基本点图">基本点图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"><span class="comment"># 基本点图</span></span><br><span class="line">p&lt;-ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">p</span><br><span class="line">ggsave(<span class="string">&#x27;d1.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改点大小和堆栈比率</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">               stackratio=<span class="number">1.5</span>, dotsize=<span class="number">1.2</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;d2.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 旋转点图</span></span><br><span class="line">p + coord_flip()</span><br><span class="line">ggsave(<span class="string">&#x27;d3.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfqMQ.png" alt></p>
<p>自定义选择想要显示的项目，比如只显示 <em>0.5</em> 和 <em>2</em> 的点图结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p + scale_x_discrete(limits=<span class="built_in">c</span>(<span class="string">&quot;0.5&quot;</span>, <span class="string">&quot;2&quot;</span>))</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;d4.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfjZn.png" alt></p>
<h2 id="在点图上添加汇总统计">在点图上添加汇总统计</h2>
<p>函数<code>stat_summary()</code>可用于向点图添加均值/中值点等</p>
<h3 id="带箱线图和小提琴图的点图">带箱线图和小提琴图的点图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加基本的箱线图</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">  geom_boxplot()+</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d5.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加带V形切迹的箱线图（Notched boxplot）</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">  geom_boxplot(notch = <span class="literal">TRUE</span>)+</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d6.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加小提琴图</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">  geom_violin(trim = <span class="literal">FALSE</span>)+</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d7.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfHxg.png" alt></p>
<h3 id="添加均值和标准差-2">添加均值和标准差</h3>
<p>使用函数 <em><strong>mean_sdl</strong></em> 。 <em><strong>mean_sdl</strong></em> 计算平均值加上或减去一个<strong>常数</strong>乘以<strong>标准偏差</strong>。</p>
<p>在下面的R代码中，常数是使用参数 <em><strong>mult(mult=1)</strong></em> 指定的。默认情况下，<em><strong>mult=2</strong></em> 。</p>
<p>平均值 +/- SD 可以添加为 <em>crossbar</em> 或 <em>pointrange</em> ：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">    geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p + stat_summary(fun.data=<span class="string">&quot;mean_sdl&quot;</span>, fun.args = <span class="built_in">list</span>(mult=<span class="number">1</span>), </span><br><span class="line">                 geom=<span class="string">&quot;crossbar&quot;</span>, width=<span class="number">0.5</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d8.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">p + stat_summary(fun.data=mean_sdl, fun.args = <span class="built_in">list</span>(mult=<span class="number">1</span>), </span><br><span class="line">                 geom=<span class="string">&quot;pointrange&quot;</span>, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d9.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXf7RS.png" alt></p>
<blockquote>
<p>还可以定义一个自定义函数来生成如下汇总统计信息。</p>
</blockquote>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成汇总统计数据的函数（平均值和 +/- sd）</span></span><br><span class="line">data_summary &lt;- <span class="keyword">function</span>(x) &#123;</span><br><span class="line">   m &lt;- mean(x)</span><br><span class="line">   ymin &lt;- m-sd(x)</span><br><span class="line">   ymax &lt;- m+sd(x)</span><br><span class="line">   <span class="built_in">return</span>(<span class="built_in">c</span>(y=m,ymin=ymin,ymax=ymax))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用自定义汇总函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p + stat_summary(fun.data=data_summary, color=<span class="string">&quot;pink&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d10.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfOqs.png" alt></p>
<h3 id="按组更改点图颜色">按组更改点图颜色</h3>
<p>这一步和之前的直方图以及密度图所用的方法是一样的，这里不再赘述了，可以查看我之前的教程内容。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用单一填充颜色</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">    geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>, fill=<span class="string">&quot;#8A2BE2&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d11.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按组更改点图颜色</span></span><br><span class="line">p&lt;-ggplot(ToothGrowth, aes(x=dose, y=len, fill=dose)) +</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">p</span><br><span class="line">ggsave(<span class="string">&#x27;d12.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfTG8.png" alt></p>
<p>使用以下函数手动更改点图颜色：</p>
<p><code>scale_fill_manual()</code> : 使用自定义颜色<br><br>
<code>scale_fill_brewer()</code> ：使用来自RColorBrewer包的调色板<br><br>
<code>scale_fill_grey()</code> ：使用灰色调色板<br></p>
<blockquote>
<p>补充一下 <em>RColorBrewer</em> 包所支持的颜色类型名称</p>
</blockquote>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oX4emj.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用自定义颜色</span></span><br><span class="line">p+scale_fill_manual(values=<span class="built_in">c</span>(<span class="string">&quot;#2e2be2&quot;</span>, <span class="string">&quot;#8a2be2&quot;</span>, <span class="string">&quot;#e22bdf&quot;</span>))</span><br><span class="line">ggsave(<span class="string">&#x27;d13.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用brewer调色板</span></span><br><span class="line">p+scale_fill_brewer(palette=<span class="string">&quot;Dark2&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d14.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用灰色调色板</span></span><br><span class="line">p + scale_fill_grey() + theme_classic()</span><br><span class="line">ggsave(<span class="string">&#x27;d15.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfoPf.png" alt></p>
<h3 id="更改图例位置-2">更改图例位置</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p + theme(legend.position=<span class="string">&quot;top&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d16.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line">p + theme(legend.position=<span class="string">&quot;bottom&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d17.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line">p + theme(legend.position=<span class="string">&quot;none&quot;</span>) <span class="comment"># 删除图例</span></span><br><span class="line">ggsave(<span class="string">&#x27;d18.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXf5IP.png" alt></p>
<h3 id="更改图例中项目的顺序">更改图例中项目的顺序</h3>
<p>函数 <em><strong>scale_x_discrete</strong></em> 可将顺序更改为“2”、“0.5”、“1”：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p + scale_x_discrete(limits=<span class="built_in">c</span>(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;0.5&quot;</span>, <span class="string">&quot;1&quot;</span>))</span><br><span class="line">ggsave(<span class="string">&#x27;d19.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfLrj.png" alt></p>
<h2 id="多组点图">多组点图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按组更改点图颜色</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len, fill=supp)) +</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d20.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 更改位置：同一组点图之间的间隔</span></span><br><span class="line">p&lt;-ggplot(ToothGrowth, aes(x=dose, y=len, fill=supp)) +</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>, </span><br><span class="line">               position=position_dodge(<span class="number">0.6</span>))</span><br><span class="line">p</span><br><span class="line">ggsave(<span class="string">&#x27;d21.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfWqA.png" alt></p>
<h3 id="更改点图颜色并添加箱线图：">更改点图颜色并添加箱线图：</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更改颜色</span></span><br><span class="line">p+scale_fill_manual(values=<span class="built_in">c</span>(<span class="string">&quot;#8a2be2&quot;</span>, <span class="string">&quot;#dfe22b&quot;</span>))</span><br><span class="line">ggsave(<span class="string">&#x27;d22.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 添加箱线图</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len, fill=supp)) +</span><br><span class="line">  geom_boxplot(fill=<span class="string">&quot;white&quot;</span>)+</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;d23.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 改变位置</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len, fill=supp)) +</span><br><span class="line">  geom_boxplot(position=position_dodge(<span class="number">0.8</span>))+</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>, </span><br><span class="line">               position=position_dodge(<span class="number">0.8</span>))</span><br><span class="line">ggsave(<span class="string">&#x27;d24.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfhVI.png" alt></p>
<h2 id="自定义点图">自定义点图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基础点图</span></span><br><span class="line">ggplot(ToothGrowth, aes(x=dose, y=len)) + </span><br><span class="line">  geom_boxplot()+</span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)+</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of length  by dose&quot;</span>,x=<span class="string">&quot;Dose (mg)&quot;</span>, y = <span class="string">&quot;Length&quot;</span>)+</span><br><span class="line">  theme_classic()</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;d25.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 按组更改颜色</span></span><br><span class="line">dp &lt;-ggplot(ToothGrowth, aes(x=dose, y=len, fill=dose)) + </span><br><span class="line">  geom_dotplot(binaxis=<span class="string">&#x27;y&#x27;</span>, stackdir=<span class="string">&#x27;center&#x27;</span>)+</span><br><span class="line">  labs(title=<span class="string">&quot;Plot of length  by dose&quot;</span>,x=<span class="string">&quot;Dose (mg)&quot;</span>, y = <span class="string">&quot;Length&quot;</span>)</span><br><span class="line">dp + theme_classic()</span><br><span class="line">ggsave(<span class="string">&#x27;d26.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXfRrd.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 连续颜色</span></span><br><span class="line">dp + scale_fill_brewer(palette=<span class="string">&quot;OrRd&quot;</span>) + theme_classic()</span><br><span class="line">ggsave(<span class="string">&#x27;d27.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 离散颜色</span></span><br><span class="line">dp + scale_fill_brewer(palette=<span class="string">&quot;Paired&quot;</span>) + theme_minimal()</span><br><span class="line">ggsave(<span class="string">&#x27;d28.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 渐变色</span></span><br><span class="line">dp + scale_fill_brewer(palette=<span class="string">&quot;PuOr&quot;</span>) + theme_minimal()</span><br><span class="line">ggsave(<span class="string">&#x27;d29.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/13/oXf4at.png" alt></p>
<h1 id="散点图">散点图</h1>
<p>本文介绍如何使用<em>ggplot2</em>包创建<strong>散点图</strong>。使用函数·<code>geom_point()</code>。</p>
<h2 id="准备数据-3">准备数据</h2>
<p>以下示例中使用了<strong>mtcars数据集</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 cyl 列从数值型(numeric)转换为因子变量(factor variable)</span></span><br><span class="line">mtcars$cyl &lt;- as.factor(mtcars$cyl)</span><br><span class="line">head(mtcars)</span><br></pre></td></tr></table></figure>
<h2 id="基本散点图">基本散点图</h2>
<p>使用下面的 R 代码创建简单的散点图。</p>
<p>可以使用函数<code>geom_point()</code>更改点的颜色、大小和形状，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geom_point(size, color, shape)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"><span class="comment"># 基本散点图</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) + geom_point()</span><br><span class="line">ggsave(<span class="string">&#x27;s01.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 改变点的形状和大小</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) +</span><br><span class="line">  geom_point(size=<span class="number">2</span>, shape=<span class="number">23</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s02.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPV2j.png" alt></p>
<blockquote>
<p>点的大小可以由连续变量的值控制，如下例所示。</p>
</blockquote>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改变点的大小</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) + </span><br><span class="line">  geom_point(aes(size=qsec))</span><br><span class="line">ggsave(<span class="string">&#x27;s03.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQP8G4.png" alt></p>
<h2 id="在散点图中标记点">在散点图中标记点</h2>
<p>可以使用函数<code>geom_text()</code>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) +</span><br><span class="line">  geom_point() + </span><br><span class="line">  geom_text(label=rownames(mtcars))</span><br><span class="line">ggsave(<span class="string">&#x27;s04.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPGRJ.png" alt></p>
<h2 id="添加回归线">添加回归线</h2>
<p>以下函数可用于向散点图添加回归线：</p>
<p><code>geom_smooth()</code><br><code>stat_smooth()</code><br><br>
<code>geom_abline()</code></p>
<p>本节仅介绍<code>geom_smooth()</code>函数。</p>
<p>一个简化的格式是：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geom_smooth(method=<span class="string">&quot;auto&quot;</span>, se=<span class="literal">TRUE</span>, fullrange=<span class="literal">FALSE</span>, level=<span class="number">0.95</span>)</span><br></pre></td></tr></table></figure>
<p><strong>方法</strong></p>
<p>要使用的平滑方法。可能的值为 <em>lm、glm、gam、loess、rlm</em></p>
<ul>
<li><strong>method = “loess”</strong>：这是少量观察的默认值。它计算平滑的局部回归。您可以使用 R 代码 <strong>?loess</strong> 阅读有关loess 的更多信息。</li>
<li><strong>method =“lm”</strong>：它适合线性模型。请注意，也可以将公式表示为 <strong>formula = y ~ poly(x, 3)</strong> 以指定 3 次多项式。</li>
<li><strong>se</strong>：逻辑值。如果为 TRUE，则置信区间显示在平滑附近。</li>
<li><strong>fullrange</strong>：逻辑值。如果为 TRUE，则拟合跨越绘图的整个范围</li>
<li><strong>level</strong>：要使用的置信区间水平。默认值为 0.95</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加回归线</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) + </span><br><span class="line">  geom_point()+</span><br><span class="line">  geom_smooth(method=lm)</span><br><span class="line">ggsave(<span class="string">&#x27;s05.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"><span class="comment"># 去除置信区间</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) + </span><br><span class="line">  geom_point()+</span><br><span class="line">  geom_smooth(method=lm, se=<span class="literal">FALSE</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s06.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Loess method</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) + </span><br><span class="line">  geom_point()+</span><br><span class="line">  geom_smooth()</span><br><span class="line">ggsave(<span class="string">&#x27;s07.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPmMn.png" alt></p>
<h2 id="更改点和线的外观">更改点和线的外观</h2>
<p>下面介绍如何更改：</p>
<ul>
<li>回归线的线型和颜色</li>
<li>置信区间的填充颜色</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更改线型和颜色</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) + </span><br><span class="line">  geom_point(shape=<span class="number">18</span>, color=<span class="string">&quot;blue&quot;</span>)+</span><br><span class="line">  geom_smooth(method=lm, se=<span class="literal">FALSE</span>, linetype=<span class="string">&quot;dashed&quot;</span>,</span><br><span class="line">             color=<span class="string">&quot;#FF0000&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s08.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改置信区间填充颜色</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) + </span><br><span class="line">  geom_point(shape=<span class="number">18</span>, color=<span class="string">&quot;blue&quot;</span>)+</span><br><span class="line">  geom_smooth(method=lm,  linetype=<span class="string">&quot;dashed&quot;</span>,</span><br><span class="line">             color=<span class="string">&quot;darkred&quot;</span>, fill=<span class="string">&quot;#87CEFA&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s09.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPZxs.png" alt></p>
<blockquote>
<p>默认情况下，置信带使用透明颜色。可以通过使用参数alpha来改变：<code>geom_smooth(fill=&quot;blue&quot;, alpha=1)</code></p>
</blockquote>
<h2 id="多组散点图">多组散点图</h2>
<p>本节介绍如何自动和手动更改点颜色和形状。</p>
<h3 id="自动更改点颜色-形状-大小">自动更改点颜色/形状/大小</h3>
<p>在下面的 R 代码中，点的形状、颜色和大小由因子变量cyl的级别控制：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过 cyl 的级别更改点形状</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, shape=cyl)) +</span><br><span class="line">  geom_point()</span><br><span class="line">ggsave(<span class="string">&#x27;s10.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改点的形状和颜色</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, shape=cyl, color=cyl)) +</span><br><span class="line">  geom_point()</span><br><span class="line">ggsave(<span class="string">&#x27;s11.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改点的形状、颜色和大小</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, shape=cyl, color=cyl, size=cyl)) +</span><br><span class="line">  geom_point()</span><br><span class="line">ggsave(<span class="string">&#x27;s12.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPnrq.png" alt></p>
<h4 id="添加回归线-2">添加回归线</h4>
<p>可以按如下方式添加回归线：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加回归线</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, color=cyl, shape=cyl)) +</span><br><span class="line">  geom_point() + </span><br><span class="line">  geom_smooth(method=lm)</span><br><span class="line">ggsave(<span class="string">&#x27;s13.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除置信区间,延长回归线</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, color=cyl, shape=cyl)) +</span><br><span class="line">  geom_point() + </span><br><span class="line">  geom_smooth(method=lm, se=<span class="literal">FALSE</span>, fullrange=<span class="literal">TRUE</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s14.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPEGQ.png" alt></p>
<blockquote>
<p>还可以使用美观的<code>linetype = cyl</code>更改回归线的线型。</p>
</blockquote>
<p>置信带的填充颜色可以更改如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, color=cyl, shape=cyl)) +</span><br><span class="line">  geom_point() + </span><br><span class="line">  geom_smooth(method=lm, aes(fill=cyl))</span><br><span class="line">ggsave(<span class="string">&#x27;s15.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="手动更改点颜色-形状-大小">手动更改点颜色/形状/大小</h3>
<p>使用了以下功能：</p>
<ul>
<li><code>scale_shape_manual()</code>用于点形状</li>
<li><code>scale_color_manual()</code>用于点颜色</li>
<li><code>scale_size_manual()</code>用于点大小</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 手动更改点的形状和颜色</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, color=cyl, shape=cyl)) +</span><br><span class="line">  geom_point() + </span><br><span class="line">  geom_smooth(method=lm, se=<span class="literal">FALSE</span>, fullrange=<span class="literal">TRUE</span>)+</span><br><span class="line">  scale_shape_manual(values=<span class="built_in">c</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">17</span>))+ </span><br><span class="line">  scale_color_manual(values=<span class="built_in">c</span>(<span class="string">&#x27;#FFA07A&#x27;</span>,<span class="string">&#x27;#87CEFA&#x27;</span>, <span class="string">&#x27;#BA55D3&#x27;</span>))+</span><br><span class="line">  theme(legend.position=<span class="string">&quot;top&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s16.png&#x27;</span>,height = <span class="number">12</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 手动更改点的尺寸</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, color=cyl, shape=cyl))+</span><br><span class="line">  geom_point(aes(size=cyl)) + </span><br><span class="line">  geom_smooth(method=lm, se=<span class="literal">FALSE</span>, fullrange=<span class="literal">TRUE</span>)+</span><br><span class="line">  scale_shape_manual(values=<span class="built_in">c</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">17</span>))+ </span><br><span class="line">  scale_color_manual(values=<span class="built_in">c</span>(<span class="string">&#x27;#FFA07A&#x27;</span>,<span class="string">&#x27;#87CEFA&#x27;</span>, <span class="string">&#x27;#BA55D3&#x27;</span>))+</span><br><span class="line">  scale_size_manual(values=<span class="built_in">c</span>(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))+</span><br><span class="line">  theme(legend.position=<span class="string">&quot;top&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s17.png&#x27;</span>,height = <span class="number">12</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPMZV.png" alt></p>
<p>也可以使用以下功能手动更改点和线颜色：</p>
<ul>
<li><code>scale_color_brewer()</code>：使用来自RColorBrewer包的调色板</li>
<li><code>scale_color_grey()</code>：使用灰色调色板</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(mtcars, aes(x=wt, y=mpg, color=cyl, shape=cyl)) +</span><br><span class="line">  geom_point() + </span><br><span class="line">  geom_smooth(method=lm, se=<span class="literal">FALSE</span>, fullrange=<span class="literal">TRUE</span>)+</span><br><span class="line">  theme_classic()</span><br><span class="line"><span class="comment"># Use brewer color palettes</span></span><br><span class="line">p+scale_color_brewer(palette=<span class="string">&quot;Dark2&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s18.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use grey scale</span></span><br><span class="line">p + scale_color_grey()</span><br><span class="line">ggsave(<span class="string">&#x27;s19.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPuq0.png" alt></p>
<h2 id="将联合分布图添加到散点图">将联合分布图添加到散点图</h2>
<p>可以使用函数<code>geom_rug()</code>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geom_rug(sides =<span class="string">&quot;bl&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>side</strong>：一个字符串，用于控制出现在哪一边。允许的值是一个字符串，其中包含 <em>trbl</em> 中的任何一个，用于顶部、右侧、底部和左侧。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加联合分布图(marginal rugs)</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg)) +</span><br><span class="line">  geom_point() + geom_rug()</span><br><span class="line">ggsave(<span class="string">&#x27;s20.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改颜色</span></span><br><span class="line">ggplot(mtcars, aes(x=wt, y=mpg, color=cyl)) +</span><br><span class="line">  geom_point() + geom_rug()</span><br><span class="line">ggsave(<span class="string">&#x27;s21.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用可靠的数据添加联合分布图</span></span><br><span class="line">ggplot(faithful, aes(x=eruptions, y=waiting)) +</span><br><span class="line">  geom_point() + geom_rug()</span><br><span class="line">ggsave(<span class="string">&#x27;s22.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPQaT.png" alt></p>
<h2 id="具有-2D-密度评估的散点图">具有 2D 密度评估的散点图</h2>
<p>可以使用函数<code>geom_density_2d()</code>或<code>stat_density_2d()</code>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 具有二维密度估计的散点图</span></span><br><span class="line">sp &lt;- ggplot(faithful, aes(x=eruptions, y=waiting)) +</span><br><span class="line">  geom_point()</span><br><span class="line">sp + geom_density_2d()</span><br><span class="line">ggsave(<span class="string">&#x27;s23.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 渐变色</span></span><br><span class="line">sp + stat_density_2d(aes(fill = ..level..), geom=<span class="string">&quot;polygon&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s24.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改渐变颜色</span></span><br><span class="line">sp + stat_density_2d(aes(fill = ..level..), geom=<span class="string">&quot;polygon&quot;</span>)+</span><br><span class="line">  scale_fill_gradient(low=<span class="string">&quot;blue&quot;</span>, high=<span class="string">&quot;red&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s25.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQPlIU.png" alt></p>
<h2 id="带椭圆的散点图">带椭圆的散点图</h2>
<p>函数<code>stat_ellipse()</code>可以如下使用：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个椭圆环绕所有点</span></span><br><span class="line">ggplot(faithful, aes(waiting, eruptions))+</span><br><span class="line">  geom_point()+</span><br><span class="line">  stat_ellipse()</span><br><span class="line">ggsave(<span class="string">&#x27;s26.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 椭圆分组</span></span><br><span class="line">p &lt;- ggplot(faithful, aes(waiting, eruptions, color = eruptions &gt; <span class="number">3</span>))+</span><br><span class="line">  geom_point()</span><br><span class="line">p + stat_ellipse()</span><br><span class="line">ggsave(<span class="string">&#x27;s27.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改椭圆的类型：可能的值为“t”、“norm”、“euclid”</span></span><br><span class="line">p + stat_ellipse(type = <span class="string">&quot;t&quot;</span>)</span><br><span class="line">ggsave(<span class="string">&#x27;s28.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">12</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s4.ax1x.com/2021/12/21/TQP3iF.png" alt></p>
<h1 id="多重相关图">多重相关图</h1>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data(iris)</span><br><span class="line">library(Hmisc)</span><br><span class="line">library(corrplot)</span><br><span class="line">res2 &lt;- rcorr(as.matrix(iris[<span class="built_in">c</span>(<span class="string">&quot;Sepal.Width&quot;</span>,<span class="string">&quot;Petal.Length&quot;</span>,<span class="string">&quot;Petal.Width&quot;</span>)]))</span><br><span class="line">corrplot(corr = res2$r,tl.col=<span class="string">&quot;black&quot;</span>,type=<span class="string">&quot;lower&quot;</span>, order=<span class="string">&quot;original&quot;</span>,tl.pos = <span class="string">&quot;d&quot;</span>,tl.cex=<span class="number">1.0</span>,</span><br><span class="line">         p.mat = res2$P, sig.level = <span class="number">0.05</span>,insig = <span class="string">&quot;blank&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohIjLF.png" alt></p>
<h1 id="火山图">火山图</h1>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(df3)</span><br><span class="line">     Gene log2FoldChange    pvalue      padj</span><br><span class="line">1    DOK6         <span class="number">0.5100</span> <span class="number">1.861e-08</span> <span class="number">0.0003053</span></span><br><span class="line">2    TBX5        -<span class="number">2.1290</span> <span class="number">5.655e-08</span> <span class="number">0.0004191</span></span><br><span class="line">3 SLC32A1         <span class="number">0.9003</span> <span class="number">7.664e-08</span> <span class="number">0.0004191</span></span><br><span class="line">4  IFITM1        -<span class="number">1.6870</span> <span class="number">3.735e-06</span> <span class="number">0.0068090</span></span><br><span class="line">5   NUP93         <span class="number">0.3659</span> <span class="number">3.373e-06</span> <span class="number">0.0068090</span></span><br><span class="line">6 EMILIN2         <span class="number">1.5340</span> <span class="number">2.976e-06</span> <span class="number">0.0068090</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">df3$threshold &lt;- as.factor(ifelse(df3$padj &lt; <span class="number">0.05</span> &amp; <span class="built_in">abs</span>(df3$log2FoldChange) &gt;=<span class="number">1</span>,ifelse(df3$log2FoldChange &gt; <span class="number">1</span> ,<span class="string">&#x27;Up&#x27;</span>,<span class="string">&#x27;Down&#x27;</span>),<span class="string">&#x27;Not&#x27;</span>))</span><br><span class="line">ggplot(data=df3, aes(x=log2FoldChange, y =-log10(padj), color=threshold,fill=threshold)) +</span><br><span class="line">  scale_color_manual(values=<span class="built_in">c</span>(<span class="string">&quot;blue&quot;</span>, <span class="string">&quot;grey&quot;</span>,<span class="string">&quot;red&quot;</span>))+</span><br><span class="line">  geom_point(size=<span class="number">1</span>) +</span><br><span class="line">  xlim(<span class="built_in">c</span>(-<span class="number">3</span>, <span class="number">3</span>)) +</span><br><span class="line">  theme_bw(base_size = <span class="number">12</span>, base_family = <span class="string">&quot;Times&quot;</span>) +</span><br><span class="line">  geom_vline(xintercept=<span class="built_in">c</span>(-<span class="number">1</span>,<span class="number">1</span>),lty=<span class="number">4</span>,col=<span class="string">&quot;grey&quot;</span>,lwd=<span class="number">0.6</span>)+</span><br><span class="line">  geom_hline(yintercept = -log10(<span class="number">0.05</span>),lty=<span class="number">4</span>,col=<span class="string">&quot;grey&quot;</span>,lwd=<span class="number">0.6</span>)+</span><br><span class="line">  theme(legend.position=<span class="string">&quot;right&quot;</span>,</span><br><span class="line">  panel.grid=element_blank(),</span><br><span class="line">        legend.title = element_blank(),</span><br><span class="line">        legend.text= element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>,family = <span class="string">&quot;Times&quot;</span>, size=<span class="number">8</span>),</span><br><span class="line">        plot.title = element_text(hjust = <span class="number">0.5</span>),</span><br><span class="line">        axis.text.x = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>, size=<span class="number">12</span>),</span><br><span class="line">        axis.text.y = element_text(face=<span class="string">&quot;bold&quot;</span>,  color=<span class="string">&quot;black&quot;</span>, size=<span class="number">12</span>),</span><br><span class="line">        axis.title.x = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>, size=<span class="number">12</span>),</span><br><span class="line">        axis.title.y = element_text(face=<span class="string">&quot;bold&quot;</span>,color=<span class="string">&quot;black&quot;</span>, size=<span class="number">12</span>))+</span><br><span class="line">  labs(x=<span class="string">&quot;log2FoldChange&quot;</span>,y=<span class="string">&quot;-log10 (adjusted p-value)&quot;</span>,title=<span class="string">&quot;Volcano plot of DEG&quot;</span>, face=<span class="string">&quot;bold&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p26.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohIxZ4.png" alt></p>
<h1 id="曼哈顿图">曼哈顿图</h1>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(df4)</span><br><span class="line">  SNP CHR BP         P</span><br><span class="line">1 rs1   <span class="number">1</span>  <span class="number">1</span> <span class="number">0.9148060</span></span><br><span class="line">2 rs2   <span class="number">1</span>  <span class="number">2</span> <span class="number">0.9370754</span></span><br><span class="line">3 rs3   <span class="number">1</span>  <span class="number">3</span> <span class="number">0.2861395</span></span><br><span class="line">4 rs4   <span class="number">1</span>  <span class="number">4</span> <span class="number">0.8304476</span></span><br><span class="line">5 rs5   <span class="number">1</span>  <span class="number">5</span> <span class="number">0.6417455</span></span><br><span class="line">6 rs6   <span class="number">1</span>  <span class="number">6</span> <span class="number">0.5190959</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">manhattan(df4, main = <span class="string">&quot;GWAS results&quot;</span>, ylim = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">8</span>),</span><br><span class="line">    cex = <span class="number">0.5</span>, cex.axis=<span class="number">0.8</span>, col=<span class="built_in">c</span>(<span class="string">&quot;dodgerblue4&quot;</span>,<span class="string">&quot;deepskyblue&quot;</span>),</span><br><span class="line">          <span class="comment">#suggestiveline = F, genomewideline = F, #remove the suggestive and genome-wide significance lines</span></span><br><span class="line">          chrlabs = <span class="built_in">as.character</span>(<span class="built_in">c</span>(<span class="number">1</span>:<span class="number">22</span>)))</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohoSo9.png" alt></p>
<h1 id="热图">热图</h1>
<h2 id="使用ggplots包heatmap-2-函数绘制热图">使用ggplots包heatmap.2()函数绘制热图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(dm)</span><br><span class="line">      Control1      Tumor2 Control3     Tumor4 Control5     Tumor1 Control2</span><br><span class="line">Gene1 <span class="number">3.646058</span> -<span class="number">0.98990248</span> <span class="number">2.210404</span> -<span class="number">0.2063050</span> <span class="number">2.859744</span>  <span class="number">1.3304284</span> <span class="number">2.690376</span></span><br><span class="line">Gene2 <span class="number">4.271172</span> -<span class="number">1.16217765</span> <span class="number">2.734119</span> -<span class="number">2.4782173</span> <span class="number">3.752013</span>  <span class="number">0.0255639</span> <span class="number">4.471795</span></span><br><span class="line">Gene3 <span class="number">3.530448</span>  <span class="number">1.11451101</span> <span class="number">1.635485</span> -<span class="number">0.4241215</span> <span class="number">3.701427</span>  <span class="number">1.2263312</span> <span class="number">3.588787</span></span><br><span class="line">Gene4 <span class="number">3.061122</span> -<span class="number">1.18791027</span> <span class="number">4.331229</span>  <span class="number">0.8733314</span> <span class="number">2.349352</span>  <span class="number">0.4825479</span> <span class="number">1.854433</span></span><br><span class="line">Gene5 <span class="number">1.956817</span>  <span class="number">0.25431042</span> <span class="number">1.984438</span>  <span class="number">1.2713845</span> <span class="number">1.685917</span>  <span class="number">1.4554739</span> <span class="number">2.445830</span></span><br><span class="line">Gene6 <span class="number">2.000919</span>  <span class="number">0.06015972</span> <span class="number">4.480901</span>  <span class="number">0.9780682</span> <span class="number">3.063475</span> -<span class="number">0.4222994</span> <span class="number">3.585366</span></span><br><span class="line">          Tumor3 Control4     Tumor5</span><br><span class="line">Gene1  <span class="number">0.6135943</span> <span class="number">2.470413</span>  <span class="number">0.5158246</span></span><br><span class="line">Gene2  <span class="number">1.6516242</span> <span class="number">2.735508</span> -<span class="number">0.5837784</span></span><br><span class="line">Gene3 -<span class="number">0.6349656</span> <span class="number">1.999844</span>  <span class="number">0.1417349</span></span><br><span class="line">Gene4 -<span class="number">1.2237684</span> <span class="number">1.154377</span> -<span class="number">0.9301261</span></span><br><span class="line">Gene5  <span class="number">0.3316909</span> <span class="number">2.715163</span>  <span class="number">0.1866400</span></span><br><span class="line">Gene6  <span class="number">1.0689000</span> <span class="number">2.563422</span>  <span class="number">1.3465830</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##为了以红色绘制高表达式值，在热图中使用colorRampPalette而不是heatmap.2</span></span><br><span class="line"><span class="comment">##colorRampPalette是RColorBrewer包中的一个函数</span></span><br><span class="line">cr &lt;- colorRampPalette(<span class="built_in">c</span>(<span class="string">&quot;red&quot;</span>,<span class="string">&quot;white&quot;</span>,<span class="string">&quot;blue&quot;</span>))</span><br><span class="line">heatmap.2(dm,</span><br><span class="line">          scale=<span class="string">&quot;row&quot;</span>, <span class="comment">#scale the rows, scale each gene&#x27;s expression value</span></span><br><span class="line">          key=<span class="built_in">T</span>, keysize=<span class="number">1.1</span>, </span><br><span class="line">          cexCol=<span class="number">0.9</span>,cexRow=<span class="number">0.8</span>,</span><br><span class="line">          col=cr(<span class="number">1000</span>),</span><br><span class="line">          ColSideColors=<span class="built_in">c</span>(<span class="built_in">rep</span>(<span class="built_in">c</span>(<span class="string">&quot;red&quot;</span>,<span class="string">&quot;blue&quot;</span>),<span class="number">5</span>)),</span><br><span class="line">          density.info=<span class="string">&quot;none&quot;</span>,trace=<span class="string">&quot;none&quot;</span>,</span><br><span class="line">          <span class="comment">#dendrogram=&#x27;none&#x27;, #如果要删除树状图解除此注释</span></span><br><span class="line">          Colv = <span class="built_in">T</span>,Rowv = <span class="built_in">T</span>) <span class="comment">#按行和列进行聚类</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohIXsU.png" alt></p>
<h2 id="使用pheatmap包的pheatmap函数绘制热图">使用pheatmap包的pheatmap函数绘制热图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##add column and row annotations</span></span><br><span class="line">annotation_col = data.frame(CellType = factor(<span class="built_in">rep</span>(<span class="built_in">c</span>(<span class="string">&quot;Control&quot;</span>, <span class="string">&quot;Tumor&quot;</span>), <span class="number">5</span>)), Time = <span class="number">1</span>:<span class="number">5</span>)</span><br><span class="line">rownames(annotation_col) = colnames(dm)</span><br><span class="line">annotation_row = data.frame(GeneClass = factor(<span class="built_in">rep</span>(<span class="built_in">c</span>(<span class="string">&quot;Path1&quot;</span>, <span class="string">&quot;Path2&quot;</span>, <span class="string">&quot;Path3&quot;</span>), <span class="built_in">c</span>(<span class="number">10</span>, <span class="number">4</span>, <span class="number">6</span>))))</span><br><span class="line">rownames(annotation_row) = paste(<span class="string">&quot;Gene&quot;</span>, <span class="number">1</span>:<span class="number">20</span>, sep = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">##set colors of each group</span></span><br><span class="line">ann_colors = <span class="built_in">list</span>(Time = <span class="built_in">c</span>(<span class="string">&quot;white&quot;</span>, <span class="string">&quot;springgreen4&quot;</span>), </span><br><span class="line">                  CellType = <span class="built_in">c</span>(Control = <span class="string">&quot;#6B8E23&quot;</span>, Tumor = <span class="string">&quot;#DA70D6&quot;</span>),</span><br><span class="line">                  GeneClass = <span class="built_in">c</span>(Path1 = <span class="string">&quot;#85e5e5&quot;</span>, Path2 = <span class="string">&quot;#afeeee&quot;</span>, Path3 = <span class="string">&quot;#d9f7f7&quot;</span>))</span><br><span class="line"><span class="comment">##draw the heatmap</span></span><br><span class="line">pheatmap(dm, </span><br><span class="line">         cutree_col = <span class="number">2</span>, cutree_row = <span class="number">3</span>, <span class="comment">#break up the heatmap by clusters you define</span></span><br><span class="line">         cluster_rows=<span class="literal">TRUE</span>, show_rownames=<span class="literal">TRUE</span>, cluster_cols=<span class="literal">TRUE</span>, <span class="comment">#by default, pheatmap clusters by both row and col</span></span><br><span class="line">         annotation_col = annotation_col, annotation_row = annotation_row,annotation_colors = ann_colors)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/o490pT.jpg" alt></p>
<h2 id="使用ggplot2软件包绘制热图">使用ggplot2软件包绘制热图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##9.3.1.cluster by row and col</span></span><br><span class="line"><span class="comment">##cluster and re-order rows</span></span><br><span class="line">rowclust = hclust(dist(dm))</span><br><span class="line">reordered = dm[rowclust$order,]</span><br><span class="line"><span class="comment">##cluster and re-order columns</span></span><br><span class="line">colclust = hclust(dist(t(dm)))</span><br><span class="line"><span class="comment">##9.3.2.scale each row value in [0,1]</span></span><br><span class="line">dm.reordered = reordered[, colclust$order]</span><br><span class="line">dm.reordered=apply(dm.reordered,<span class="number">1</span>,rescale) <span class="comment">#rescale is a function in the scales package</span></span><br><span class="line">dm.reordered=t(dm.reordered) <span class="comment">#transposed matrix</span></span><br><span class="line"><span class="comment">##9.3.3.save col and row names before changing the matrix format</span></span><br><span class="line">col_name=colnames(dm.reordered) </span><br><span class="line">row_name=rownames(dm.reordered) </span><br><span class="line"><span class="comment">##9.3.4.change data format for geom_title </span></span><br><span class="line">colnames(dm.reordered)=<span class="number">1</span>:ncol(dm.reordered)</span><br><span class="line">rownames(dm.reordered)=<span class="number">1</span>:nrow(dm.reordered)</span><br><span class="line">dm.reordered=melt(dm.reordered) <span class="comment">#melt is a function in the reshape2 package</span></span><br><span class="line">head(dm.reordered)</span><br><span class="line"><span class="comment">##9.3.5.draw the heatmap</span></span><br><span class="line">ggplot(dm.reordered, aes(Var2, Var1)) + </span><br><span class="line">  geom_tile(aes(fill = value), color = <span class="string">&quot;white&quot;</span>) + </span><br><span class="line">  scale_fill_gradient(low = <span class="string">&quot;white&quot;</span>, high = <span class="string">&quot;steelblue&quot;</span>) +</span><br><span class="line">  theme_grey(base_size = <span class="number">6</span>) + </span><br><span class="line">  labs(x = <span class="string">&quot;&quot;</span>, y = <span class="string">&quot;&quot;</span>) + </span><br><span class="line">  scale_x_continuous(expand = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>),labels=col_name,breaks=<span class="number">1</span>:<span class="built_in">length</span>(col_name)) + </span><br><span class="line">  scale_y_continuous(expand = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0</span>),labels=row_name,breaks=<span class="number">1</span>:<span class="built_in">length</span>(row_name))</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p30.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">15</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohI7in.png" alt></p>
<h1 id="气球图">气球图</h1>
<h2 id="基础气球图制作">基础气球图制作</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(df6)</span><br><span class="line">                   Biological.process Fold.enrichment X.log10.Pvalue. col</span><br><span class="line">1    Small molecule metabolic process             <span class="number">1.0</span>              <span class="number">16</span>   <span class="number">1</span></span><br><span class="line">2   Single-organism catabolic process             <span class="number">1.5</span>              <span class="number">12</span>   <span class="number">1</span></span><br><span class="line">3           Oxoacid metabolic process             <span class="number">2.0</span>              <span class="number">23</span>   <span class="number">1</span></span><br><span class="line">4 Small molecule biosynthetic process             <span class="number">2.5</span>               <span class="number">6</span>   <span class="number">1</span></span><br><span class="line">5   Carboxylic acid metabolic process             <span class="number">2.7</span>              <span class="number">24</span>   <span class="number">1</span></span><br><span class="line">6      Organic acid metabolic process</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df6, aes(x=Fold.enrichment, y=Biological.process)) +</span><br><span class="line">  geom_point(aes(size = X.log10.Pvalue.)) +</span><br><span class="line">  scale_x_continuous(limits=<span class="built_in">c</span>(<span class="number">0</span>,<span class="number">7</span>),breaks=<span class="number">0</span>:<span class="number">7</span>) +</span><br><span class="line">  scale_size(breaks=<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">20</span>,<span class="number">25</span>)) +</span><br><span class="line">  theme_light() +</span><br><span class="line">  theme(panel.border=element_rect(fill=<span class="string">&#x27;transparent&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, size=<span class="number">1</span>),</span><br><span class="line">        plot.title = element_text(color=<span class="string">&quot;black&quot;</span>, size=<span class="number">12</span>, hjust=<span class="number">0.5</span>, face=<span class="string">&quot;bold&quot;</span>, lineheight=<span class="number">1</span>),</span><br><span class="line">        axis.title.x = element_text(color=<span class="string">&quot;black&quot;</span>, size=<span class="number">8</span>, face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">        axis.title.y = element_text(color=<span class="string">&quot;black&quot;</span>, size=<span class="number">10</span>, vjust=<span class="number">1.5</span>, face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">        axis.text.x = element_text(size=<span class="number">10</span>,color=<span class="string">&quot;black&quot;</span>,face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">        axis.text.y = element_text(size=<span class="number">10</span>,color=<span class="string">&quot;black&quot;</span>,face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">        legend.text = element_text(color=<span class="string">&quot;black&quot;</span>, size=<span class="number">10</span>, hjust=-<span class="number">2</span>),</span><br><span class="line">        legend.position=<span class="string">&quot;bottom&quot;</span>) +</span><br><span class="line">  labs(x=<span class="string">&quot;Fold Enrichment&quot;</span>,y=<span class="string">&quot;Biological Process&quot;</span>,size=<span class="string">&quot;-log10(Pvalue)&quot;</span>, title=<span class="string">&quot;GO Enrichment (Test data)&quot;</span>,face=<span class="string">&quot;bold&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p31.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">15</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohIbR0.png" alt></p>
<h2 id="改变点的颜色">改变点的颜色</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ggplot(df6, aes(x=col, y=Biological.process,color=X.log10.Pvalue.)) +</span><br><span class="line">  geom_point(aes(size = Fold.enrichment)) +</span><br><span class="line">  scale_x_discrete(limits=<span class="built_in">c</span>(<span class="string">&quot;1&quot;</span>)) +</span><br><span class="line">  scale_size(breaks=<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>)) +</span><br><span class="line">  scale_color_gradient(low=<span class="string">&quot;#fcbba1&quot;</span>, high=<span class="string">&quot;#a50f15&quot;</span>) +</span><br><span class="line">  theme_classic() +</span><br><span class="line">  theme(panel.border=element_rect(fill=<span class="string">&#x27;transparent&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, size=<span class="number">1</span>),</span><br><span class="line">        plot.title = element_text(color=<span class="string">&quot;black&quot;</span>, size=<span class="number">12</span>, hjust=<span class="number">0.5</span>, face=<span class="string">&quot;bold&quot;</span>, lineheight=<span class="number">1</span>),</span><br><span class="line">        axis.title.x = element_blank(),</span><br><span class="line">        axis.title.y = element_text(color=<span class="string">&quot;black&quot;</span>, size=<span class="number">10</span>, face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">        axis.text.x = element_blank(),</span><br><span class="line">        axis.ticks = element_blank(),</span><br><span class="line">        axis.text.y = element_text(size=<span class="number">10</span>,color=<span class="string">&quot;black&quot;</span>,face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">        legend.text = element_text(color=<span class="string">&quot;black&quot;</span>, size=<span class="number">8</span>)) +</span><br><span class="line">  labs(y=<span class="string">&quot;Biological Process&quot;</span>,size=<span class="string">&quot;Fold Enrichment&quot;</span>, color=<span class="string">&quot;-Log10(Pvalue)&quot;</span>,title=<span class="string">&quot;GO Enrichment (Test data)&quot;</span>,face=<span class="string">&quot;bold&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p32.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">16</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohIqzV.png" alt></p>
<h1 id="组合条形图">组合条形图</h1>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">library(reshape2)</span><br><span class="line"><span class="comment">#build example matrix</span></span><br><span class="line">mat &lt;- as.data.frame(<span class="built_in">list</span>(<span class="built_in">c</span>(<span class="number">100</span>,<span class="number">10</span>,<span class="number">1</span>),<span class="built_in">c</span>(<span class="number">3</span>,<span class="number">6</span>,<span class="number">100</span>)))</span><br><span class="line">colnames(mat) &lt;- <span class="built_in">c</span>(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>)</span><br><span class="line">rownames(mat) &lt;- <span class="built_in">c</span>(<span class="string">&quot;gene1&quot;</span>,<span class="string">&quot;gene2&quot;</span>,<span class="string">&quot;gene3&quot;</span>)</span><br><span class="line">plot &lt;- melt(mat)</span><br><span class="line">plot$gene &lt;- <span class="built_in">rep</span>(<span class="built_in">c</span>(<span class="string">&quot;gene1&quot;</span>,<span class="string">&quot;gene2&quot;</span>,<span class="string">&quot;gene3&quot;</span>),ncol(mat))</span><br><span class="line">colnames(plot) &lt;- <span class="built_in">c</span>(<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;value&quot;</span>,<span class="string">&quot;gene&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#barplot</span></span><br><span class="line">library(ggpubr)</span><br><span class="line">plot_a &lt;- plot[plot$sample==<span class="string">&quot;a&quot;</span>,]</span><br><span class="line">plot_b &lt;- plot[plot$sample==<span class="string">&quot;b&quot;</span>,]</span><br><span class="line">barplot_theme &lt;- <span class="keyword">function</span>()&#123;</span><br><span class="line">  theme(</span><br><span class="line">    plot.margin = unit(x=<span class="built_in">c</span>(<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">5</span>),units=<span class="string">&quot;pt&quot;</span>),</span><br><span class="line">    legend.position=<span class="string">&quot;null&quot;</span>,</span><br><span class="line">    panel.grid=element_blank(),</span><br><span class="line">    panel.border=element_blank(),</span><br><span class="line">    axis.line.y = element_line(color = <span class="string">&quot;black&quot;</span>,size = <span class="number">1.5</span>),</span><br><span class="line">    axis.ticks.y = element_line(color = <span class="string">&quot;black&quot;</span>,size = <span class="number">1.5</span>),</span><br><span class="line">    axis.ticks.x = element_blank(),</span><br><span class="line">    legend.title = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>,family = <span class="string">&quot;Arial&quot;</span>, size=<span class="number">20</span>),</span><br><span class="line">    legend.text= element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>,family = <span class="string">&quot;Arial&quot;</span>, size=<span class="number">20</span>),</span><br><span class="line">    plot.title = element_text(hjust = <span class="number">0.5</span>,size=<span class="number">24</span>,face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">    axis.text.x = element_blank(),</span><br><span class="line">    <span class="comment">#axis.text.x = element_text(face=&quot;bold&quot;, color=&quot;black&quot;, size=20, angle = 90,hjust = 0,vjust = 0.5),</span></span><br><span class="line">    axis.text.y = element_text(face=<span class="string">&quot;bold&quot;</span>,  color=<span class="string">&quot;black&quot;</span>, size=<span class="number">18</span>, angle = <span class="number">90</span>,hjust=<span class="number">0.5</span>),</span><br><span class="line">    axis.title.x = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>, size=<span class="number">24</span>),</span><br><span class="line">    axis.title.y = element_text(face=<span class="string">&quot;bold&quot;</span>,color=<span class="string">&quot;black&quot;</span>, size=<span class="number">24</span>))</span><br><span class="line">&#125;</span><br><span class="line">p_a &lt;- ggplot(plot_a,aes(x=gene,y=value,fill=sample))+geom_bar(stat = <span class="string">&quot;identity&quot;</span>,color = <span class="string">&quot;black&quot;</span>,size = <span class="number">1.2</span>)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  xlab(<span class="string">&quot;&quot;</span>)+</span><br><span class="line">  ylab(<span class="string">&quot;value: a&quot;</span>)+</span><br><span class="line">  barplot_theme()+</span><br><span class="line">  scale_fill_manual(values=<span class="built_in">c</span>(<span class="string">&quot;blue&quot;</span>))</span><br><span class="line"></span><br><span class="line">p_b &lt;- ggplot(plot_b,aes(x=gene,y=value,fill=sample))+geom_bar(stat = <span class="string">&quot;identity&quot;</span>,color = <span class="string">&quot;black&quot;</span>, size= <span class="number">1.2</span>)+</span><br><span class="line">  theme_bw()+</span><br><span class="line">  scale_y_reverse()+</span><br><span class="line">  xlab(<span class="string">&quot;&quot;</span>)+</span><br><span class="line">  ylab(<span class="string">&quot;value: b&quot;</span>)+</span><br><span class="line">  barplot_theme()+</span><br><span class="line">  scale_fill_manual(values = <span class="built_in">c</span>(<span class="string">&quot;red&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#plot combination</span></span><br><span class="line">ggarrange(p_a, p_b,</span><br><span class="line">          ncol = <span class="number">1</span>, nrow = <span class="number">2</span>,heights = <span class="number">5</span>,align = <span class="built_in">c</span>(<span class="string">&quot;v&quot;</span>))</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p33.png&#x27;</span>,height = <span class="number">10</span>,width = <span class="number">10</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/o49xgS.png" alt></p>
<h1 id="堆积条形图">堆积条形图</h1>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#build example matrix</span></span><br><span class="line">fraction &lt;- as.data.frame(<span class="built_in">list</span>(<span class="built_in">c</span>(<span class="number">0.2</span>,<span class="number">0.3</span>,<span class="number">0.5</span>),<span class="built_in">c</span>(<span class="number">0.1</span>,<span class="number">0.7</span>,<span class="number">0.2</span>),<span class="built_in">c</span>(<span class="number">0.8</span>,<span class="number">0.1</span>,<span class="number">0.1</span>)))</span><br><span class="line">colnames(fraction) &lt;- <span class="built_in">c</span>(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>)</span><br><span class="line">rownames(fraction) &lt;- <span class="built_in">c</span>(<span class="string">&quot;componentA&quot;</span>,<span class="string">&quot;componentB&quot;</span>,<span class="string">&quot;componentC&quot;</span>)</span><br><span class="line">fraction</span><br><span class="line">stackplot &lt;- melt(fraction)</span><br><span class="line">stackplot$component &lt;- <span class="built_in">rep</span>(<span class="built_in">c</span>(<span class="string">&quot;componentA&quot;</span>,<span class="string">&quot;componentB&quot;</span>,<span class="string">&quot;componentC&quot;</span>),ncol(fraction))</span><br><span class="line">colnames(stackplot) &lt;- <span class="built_in">c</span>(<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;fraction&quot;</span>,<span class="string">&quot;component&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#stackplot</span></span><br><span class="line">ggplot(stackplot,aes(x=sample,y=fraction*<span class="number">100</span>,fill = component)) + geom_bar(stat = <span class="string">&quot;identity&quot;</span>, width=<span class="number">0.5</span>, col=<span class="string">&#x27;black&#x27;</span>) +</span><br><span class="line">  theme_bw()+</span><br><span class="line">  theme(<span class="comment">#legend.position=&quot;bottom&quot;,</span></span><br><span class="line">    legend.position=<span class="string">&quot;right&quot;</span>,</span><br><span class="line">    panel.grid=element_blank(),</span><br><span class="line">    legend.title = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>,family = <span class="string">&quot;Arial&quot;</span>, size=<span class="number">20</span>),</span><br><span class="line">    legend.text= element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>,family = <span class="string">&quot;Arial&quot;</span>, size=<span class="number">20</span>),</span><br><span class="line">    plot.title = element_text(hjust = <span class="number">0.5</span>,size=<span class="number">24</span>,face=<span class="string">&quot;bold&quot;</span>),</span><br><span class="line">    axis.text.x = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>, size=<span class="number">20</span>,angle = <span class="number">90</span>,hjust = <span class="number">1</span>,vjust =<span class="number">0.5</span>),</span><br><span class="line">    axis.text.y = element_text(face=<span class="string">&quot;bold&quot;</span>,  color=<span class="string">&quot;black&quot;</span>, size=<span class="number">20</span>),</span><br><span class="line">    axis.title.x = element_text(face=<span class="string">&quot;bold&quot;</span>, color=<span class="string">&quot;black&quot;</span>, size=<span class="number">24</span>),</span><br><span class="line">    axis.title.y = element_text(face=<span class="string">&quot;bold&quot;</span>,color=<span class="string">&quot;black&quot;</span>, size=<span class="number">24</span>))+</span><br><span class="line">  ylab(<span class="string">&quot;Fraction(%)&quot;</span>)+</span><br><span class="line">  xlab(<span class="string">&quot;&quot;</span>)+</span><br><span class="line">  <span class="comment">#geom_vline(aes(xintercept=6.5))+</span></span><br><span class="line">  scale_y_continuous(breaks = <span class="built_in">c</span>(<span class="number">0</span>,<span class="number">25</span>,<span class="number">50</span>,<span class="number">75</span>,<span class="number">100</span>),labels = <span class="built_in">c</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;25&quot;</span>,<span class="string">&quot;50&quot;</span>,<span class="string">&quot;75&quot;</span>,<span class="string">&quot;100&quot;</span>),expand = <span class="built_in">c</span>(<span class="number">0</span>,<span class="number">0</span>),limits = <span class="built_in">c</span>(<span class="number">0</span>,<span class="number">103</span>))</span><br><span class="line">scale_fill_aaas(alpha = <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&#x27;p34.png&#x27;</span>,height = <span class="number">12</span>,width = <span class="number">15</span>,units = <span class="string">&#x27;cm&#x27;</span>,dpi = <span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><br><img src="https://s1.ax1x.com/2021/12/09/ohIHGq.png" alt></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:lixingzee@gmail.com" rel="external nofollow noreferrer">李星泽</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://lxz9.com/2021/12/14/R/">http://lxz9.com/2021/12/14/R/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lxz9.com" target="_blank">生信技术</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/R%E8%AF%AD%E8%A8%80/">R语言</a></div><div class="post_share"><div class="social-share" data-image="https://s4.ax1x.com/2021/12/15/ozG2Ed.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://z3.ax1x.com/2021/01/19/sgZ5y6.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://z3.ax1x.com/2021/01/19/sgZ5y6.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://z3.ax1x.com/2021/01/19/sgZIOK.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://z3.ax1x.com/2021/01/19/sgZIOK.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/12/15/Conserved_Sequences/"><img class="prev-cover" src="https://s4.ax1x.com/2021/12/15/ozGUE9.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">保守序列的生物学意义｜用 K-mers 寻找保守序列</div></div></a></div><div class="next-post pull-right"><a href="/2021/12/01/Protein_structure_prediction/"><img class="next-cover" src="https://z3.ax1x.com/2021/12/02/oYdAsA.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">使用同源建模预测蛋白质结构</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://z3.ax1x.com/2021/03/10/6JSyoq.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">李星泽</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">33</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">48</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://blog.csdn.net/m0_49960764" rel="external nofollow noreferrer" target="_blank" title="CSDN"><i class="iconfont icon-csdn"></i></a><a class="social-icon" href="https://z3.ax1x.com/2021/11/25/oAI0h9.jpg" rel="external nofollow noreferrer" target="_blank" title="微信公众号"><i class="iconfont icon-weixin"></i></a><a class="social-icon" href="https://space.bilibili.com/113291922?from=search&amp;seid=3526734520747213504&amp;spm_id_from=333.337.0.0" rel="external nofollow noreferrer" target="_blank" title="bilibili"><i class="iconfont icon-bilibili-copy"></i></a><a class="social-icon" href="mailto:lixingzee@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">如果你有更多想了解的内容，欢迎关注我的个人公众号：<b>生信技术</b> <img src="https://s4.ax1x.com/2021/12/23/TGLCTS.png"> <br> <br></div><timing></timing></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#R%E5%8C%85%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">R包安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="toc-number">3.</span> <span class="toc-text">加载数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%9D%E5%AD%98%E5%B9%B6%E6%9F%A5%E7%9C%8B%E5%9B%BE%E7%89%87"><span class="toc-number">4.</span> <span class="toc-text">保存并查看图片</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#R%E5%8C%85%E5%AF%BC%E5%87%BA%E9%AB%98%E8%B4%A8%E9%87%8F%E5%8F%AF%E7%BC%96%E8%BE%91%E5%9B%BE%E5%BD%A2"><span class="toc-number">5.</span> <span class="toc-text">R包导出高质量可编辑图形</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%B1%E7%BA%BF%E5%9B%BE"><span class="toc-number">6.</span> <span class="toc-text">箱线图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%AE%B1%E7%BA%BF%E5%9B%BE%E5%88%B6%E4%BD%9C"><span class="toc-number">6.1.</span> <span class="toc-text">基本箱线图制作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E7%BB%84%E6%9B%B4%E6%94%B9%E8%BF%9E%E7%BB%AD%E9%A2%9C%E8%89%B2"><span class="toc-number">6.2.</span> <span class="toc-text">按组更改连续颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E7%AE%B1%E7%BA%BF%E5%9B%BE"><span class="toc-number">6.3.</span> <span class="toc-text">分组箱线图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%A6%E7%BB%9F%E8%AE%A1%E6%A3%80%E9%AA%8C%E7%9A%84%E7%AE%B1%E7%BA%BF%E5%9B%BE"><span class="toc-number">6.4.</span> <span class="toc-text">带统计检验的箱线图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8F%E6%8F%90%E7%90%B4%E5%9B%BE"><span class="toc-number">7.</span> <span class="toc-text">小提琴图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%B0%8F%E6%8F%90%E7%90%B4%E5%9B%BE%E5%88%B6%E4%BD%9C"><span class="toc-number">7.1.</span> <span class="toc-text">基本小提琴图制作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E5%B0%8F%E6%8F%90%E7%90%B4%E5%9B%BE%E4%B8%8A%E6%B7%BB%E5%8A%A0%E6%B1%87%E6%80%BB%E7%BB%9F%E8%AE%A1"><span class="toc-number">7.2.</span> <span class="toc-text">在小提琴图上添加汇总统计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%B8%AD%E4%BD%8D%E6%95%B0%E5%92%8C%E5%9B%9B%E5%88%86%E4%BD%8D%E6%95%B0"><span class="toc-number">7.2.1.</span> <span class="toc-text">添加中位数和四分位数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%9D%87%E5%80%BC%E5%92%8C%E6%A0%87%E5%87%86%E5%B7%AE"><span class="toc-number">7.2.2.</span> <span class="toc-text">添加均值和标准差</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%B0%8F%E6%8F%90%E7%90%B4%E5%9B%BE%E5%A1%AB%E5%85%85%E9%A2%9C%E8%89%B2"><span class="toc-number">7.2.3.</span> <span class="toc-text">更改小提琴图填充颜色</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B4%E6%96%B9%E5%9B%BE"><span class="toc-number">8.</span> <span class="toc-text">直方图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9B%B4%E6%96%B9%E5%9B%BE%E5%88%B6%E4%BD%9C"><span class="toc-number">8.1.</span> <span class="toc-text">基础直方图制作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%9B%B4%E6%96%B9%E5%9B%BE%E4%B8%8A%E6%B7%BB%E5%8A%A0%E5%B9%B3%E5%9D%87%E7%BA%BF%E5%92%8C%E5%AF%86%E5%BA%A6%E5%9B%BE"><span class="toc-number">8.2.</span> <span class="toc-text">在直方图上添加平均线和密度图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E7%9B%B4%E6%96%B9%E5%9B%BE%E5%A1%AB%E5%85%85%E9%A2%9C%E8%89%B2%E5%92%8C%E7%BA%BF%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">8.3.</span> <span class="toc-text">更改直方图填充颜色和线的类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E7%BB%84%E6%9B%B4%E6%94%B9%E7%9B%B4%E6%96%B9%E5%9B%BE%E9%A2%9C%E8%89%B2"><span class="toc-number">8.4.</span> <span class="toc-text">按组更改直方图颜色</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%AF%8F%E7%BB%84%E7%9A%84%E5%B9%B3%E5%9D%87%E5%80%BC%EF%BC%9A"><span class="toc-number">8.4.1.</span> <span class="toc-text">计算每组的平均值：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E7%BA%BF%E6%9D%A1%E9%A2%9C%E8%89%B2"><span class="toc-number">8.4.2.</span> <span class="toc-text">更改线条颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%A1%AB%E5%85%85%E9%A2%9C%E8%89%B2"><span class="toc-number">8.4.3.</span> <span class="toc-text">更改填充颜色</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%86%E5%BA%A6%E5%9B%BE"><span class="toc-number">9.</span> <span class="toc-text">密度图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE"><span class="toc-number">9.1.</span> <span class="toc-text">准备数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%AF%86%E5%BA%A6%E5%9B%BE"><span class="toc-number">9.2.</span> <span class="toc-text">基本密度图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%AF%86%E5%BA%A6%E5%9B%BE%E7%BA%BF%E7%B1%BB%E5%9E%8B%E5%92%8C%E9%A2%9C%E8%89%B2"><span class="toc-number">9.3.</span> <span class="toc-text">更改密度图线类型和颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E7%BB%84%E6%9B%B4%E6%94%B9%E5%AF%86%E5%BA%A6%E5%9B%BE%E9%A2%9C%E8%89%B2"><span class="toc-number">9.4.</span> <span class="toc-text">按组更改密度图颜色</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%AF%8F%E7%BB%84%E7%9A%84%E5%B9%B3%E5%9D%87%E5%80%BC"><span class="toc-number">9.4.1.</span> <span class="toc-text">计算每组的平均值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E7%BA%BF%E6%9D%A1%E9%A2%9C%E8%89%B2-2"><span class="toc-number">9.4.2.</span> <span class="toc-text">更改线条颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%A1%AB%E5%85%85%E9%A2%9C%E8%89%B2-2"><span class="toc-number">9.4.3.</span> <span class="toc-text">更改填充颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%9B%BE%E4%BE%8B%E4%BD%8D%E7%BD%AE"><span class="toc-number">9.4.4.</span> <span class="toc-text">更改图例位置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E5%90%88%E7%9B%B4%E6%96%B9%E5%9B%BE%E5%92%8C%E5%AF%86%E5%BA%A6%E5%9B%BE"><span class="toc-number">9.5.</span> <span class="toc-text">结合直方图和密度图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%82%B9%E5%9B%BE"><span class="toc-number">10.</span> <span class="toc-text">点图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE-2"><span class="toc-number">10.1.</span> <span class="toc-text">准备数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%82%B9%E5%9B%BE"><span class="toc-number">10.2.</span> <span class="toc-text">基本点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%82%B9%E5%9B%BE%E4%B8%8A%E6%B7%BB%E5%8A%A0%E6%B1%87%E6%80%BB%E7%BB%9F%E8%AE%A1"><span class="toc-number">10.3.</span> <span class="toc-text">在点图上添加汇总统计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E7%AE%B1%E7%BA%BF%E5%9B%BE%E5%92%8C%E5%B0%8F%E6%8F%90%E7%90%B4%E5%9B%BE%E7%9A%84%E7%82%B9%E5%9B%BE"><span class="toc-number">10.3.1.</span> <span class="toc-text">带箱线图和小提琴图的点图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%9D%87%E5%80%BC%E5%92%8C%E6%A0%87%E5%87%86%E5%B7%AE-2"><span class="toc-number">10.3.2.</span> <span class="toc-text">添加均值和标准差</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%BB%84%E6%9B%B4%E6%94%B9%E7%82%B9%E5%9B%BE%E9%A2%9C%E8%89%B2"><span class="toc-number">10.3.3.</span> <span class="toc-text">按组更改点图颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%9B%BE%E4%BE%8B%E4%BD%8D%E7%BD%AE-2"><span class="toc-number">10.3.4.</span> <span class="toc-text">更改图例位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%9B%BE%E4%BE%8B%E4%B8%AD%E9%A1%B9%E7%9B%AE%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-number">10.3.5.</span> <span class="toc-text">更改图例中项目的顺序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BB%84%E7%82%B9%E5%9B%BE"><span class="toc-number">10.4.</span> <span class="toc-text">多组点图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E7%82%B9%E5%9B%BE%E9%A2%9C%E8%89%B2%E5%B9%B6%E6%B7%BB%E5%8A%A0%E7%AE%B1%E7%BA%BF%E5%9B%BE%EF%BC%9A"><span class="toc-number">10.4.1.</span> <span class="toc-text">更改点图颜色并添加箱线图：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%82%B9%E5%9B%BE"><span class="toc-number">10.5.</span> <span class="toc-text">自定义点图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">11.</span> <span class="toc-text">散点图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE-3"><span class="toc-number">11.1.</span> <span class="toc-text">准备数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">11.2.</span> <span class="toc-text">基本散点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E6%95%A3%E7%82%B9%E5%9B%BE%E4%B8%AD%E6%A0%87%E8%AE%B0%E7%82%B9"><span class="toc-number">11.3.</span> <span class="toc-text">在散点图中标记点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%9B%9E%E5%BD%92%E7%BA%BF"><span class="toc-number">11.4.</span> <span class="toc-text">添加回归线</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E7%82%B9%E5%92%8C%E7%BA%BF%E7%9A%84%E5%A4%96%E8%A7%82"><span class="toc-number">11.5.</span> <span class="toc-text">更改点和线的外观</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BB%84%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">11.6.</span> <span class="toc-text">多组散点图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%94%B9%E7%82%B9%E9%A2%9C%E8%89%B2-%E5%BD%A2%E7%8A%B6-%E5%A4%A7%E5%B0%8F"><span class="toc-number">11.6.1.</span> <span class="toc-text">自动更改点颜色&#x2F;形状&#x2F;大小</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%9B%9E%E5%BD%92%E7%BA%BF-2"><span class="toc-number">11.6.1.1.</span> <span class="toc-text">添加回归线</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%9B%B4%E6%94%B9%E7%82%B9%E9%A2%9C%E8%89%B2-%E5%BD%A2%E7%8A%B6-%E5%A4%A7%E5%B0%8F"><span class="toc-number">11.6.2.</span> <span class="toc-text">手动更改点颜色&#x2F;形状&#x2F;大小</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%86%E8%81%94%E5%90%88%E5%88%86%E5%B8%83%E5%9B%BE%E6%B7%BB%E5%8A%A0%E5%88%B0%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">11.7.</span> <span class="toc-text">将联合分布图添加到散点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E6%9C%89-2D-%E5%AF%86%E5%BA%A6%E8%AF%84%E4%BC%B0%E7%9A%84%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">11.8.</span> <span class="toc-text">具有 2D 密度评估的散点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%A6%E6%A4%AD%E5%9C%86%E7%9A%84%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">11.9.</span> <span class="toc-text">带椭圆的散点图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E7%9B%B8%E5%85%B3%E5%9B%BE"><span class="toc-number">12.</span> <span class="toc-text">多重相关图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%81%AB%E5%B1%B1%E5%9B%BE"><span class="toc-number">13.</span> <span class="toc-text">火山图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9B%BC%E5%93%88%E9%A1%BF%E5%9B%BE"><span class="toc-number">14.</span> <span class="toc-text">曼哈顿图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%83%AD%E5%9B%BE"><span class="toc-number">15.</span> <span class="toc-text">热图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ggplots%E5%8C%85heatmap-2-%E5%87%BD%E6%95%B0%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE"><span class="toc-number">15.1.</span> <span class="toc-text">使用ggplots包heatmap.2()函数绘制热图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8pheatmap%E5%8C%85%E7%9A%84pheatmap%E5%87%BD%E6%95%B0%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE"><span class="toc-number">15.2.</span> <span class="toc-text">使用pheatmap包的pheatmap函数绘制热图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ggplot2%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE"><span class="toc-number">15.3.</span> <span class="toc-text">使用ggplot2软件包绘制热图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B0%94%E7%90%83%E5%9B%BE"><span class="toc-number">16.</span> <span class="toc-text">气球图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%B0%94%E7%90%83%E5%9B%BE%E5%88%B6%E4%BD%9C"><span class="toc-number">16.1.</span> <span class="toc-text">基础气球图制作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E7%82%B9%E7%9A%84%E9%A2%9C%E8%89%B2"><span class="toc-number">16.2.</span> <span class="toc-text">改变点的颜色</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%9D%A1%E5%BD%A2%E5%9B%BE"><span class="toc-number">17.</span> <span class="toc-text">组合条形图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A0%86%E7%A7%AF%E6%9D%A1%E5%BD%A2%E5%9B%BE"><span class="toc-number">18.</span> <span class="toc-text">堆积条形图</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/12/24/LCS/" title="使用最长公共子序列算法进行序列比对"><img src="https://s4.ax1x.com/2021/12/24/TNcvZj.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用最长公共子序列算法进行序列比对"/></a><div class="content"><a class="title" href="/2021/12/24/LCS/" title="使用最长公共子序列算法进行序列比对">使用最长公共子序列算法进行序列比对</a><time datetime="2021-12-24T15:00:00.000Z" title="发表于 2021-12-24 23:00:00">2021-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/21/pypubmed/" title="PyPubMed｜一款进行文献检索的工具"><img src="https://s4.ax1x.com/2021/12/21/TKoMjA.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PyPubMed｜一款进行文献检索的工具"/></a><div class="content"><a class="title" href="/2021/12/21/pypubmed/" title="PyPubMed｜一款进行文献检索的工具">PyPubMed｜一款进行文献检索的工具</a><time datetime="2021-12-21T03:00:00.000Z" title="发表于 2021-12-21 11:00:00">2021-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/15/Conserved_Sequences/" title="保守序列的生物学意义｜用 K-mers 寻找保守序列"><img src="https://s4.ax1x.com/2021/12/15/ozGUE9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="保守序列的生物学意义｜用 K-mers 寻找保守序列"/></a><div class="content"><a class="title" href="/2021/12/15/Conserved_Sequences/" title="保守序列的生物学意义｜用 K-mers 寻找保守序列">保守序列的生物学意义｜用 K-mers 寻找保守序列</a><time datetime="2021-12-15T10:00:00.000Z" title="发表于 2021-12-15 18:00:00">2021-12-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/14/R/" title="R语言基础画图教程合集(长文总结)"><img src="https://s4.ax1x.com/2021/12/15/ozG2Ed.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="R语言基础画图教程合集(长文总结)"/></a><div class="content"><a class="title" href="/2021/12/14/R/" title="R语言基础画图教程合集(长文总结)">R语言基础画图教程合集(长文总结)</a><time datetime="2021-12-14T10:00:00.000Z" title="发表于 2021-12-14 18:00:00">2021-12-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/01/Protein_structure_prediction/" title="使用同源建模预测蛋白质结构"><img src="https://z3.ax1x.com/2021/12/02/oYdAsA.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用同源建模预测蛋白质结构"/></a><div class="content"><a class="title" href="/2021/12/01/Protein_structure_prediction/" title="使用同源建模预测蛋白质结构">使用同源建模预测蛋白质结构</a><time datetime="2021-12-01T15:00:00.000Z" title="发表于 2021-12-01 23:00:00">2021-12-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021&nbsp;<i style="color:#FF6A6A;animation: announ_animation 0.8s linear infinite;"class="fas fa-heart"></i> By 李星泽</div></div><div class="container" id="jsi-flying-fish-container"><script src="/js/fish.js"></script></div><style>   @media only screen and (max-width: 767px){
   #sidebar_search_box input[type=text]{width:calc(100% - 24px)}
}</style></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: '',
      appKey: '',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/js/jquery.min.js"></script><script src="/js/fish.js"></script><script src="/js/timing.js"></script><script async src="https://cdn.jsdelivr.net/npm/aplayer"></script><script async src="https://cdn.jsdelivr.net/npm/meting/dist/Meting.min.js"></script><div class="aplayer no-destroy" data-id="000PeZCQ1i4XVs" data-server="tencent" data-type="artist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="flase" muted></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/f84bbafb.js","daovoice")
</script><script>var isChatBtn = false
daovoice('init', {
  app_id: 'f84bbafb',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', 'G-QRG4NL4207', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>